{"version":3,"sources":["scrollbars.js","components/EditLine.js","components/Code.js","ServiceContext.js","libs/url.js","libs/WindowMessageManager.ts","components/GistComment.js","components/GistComments.js","components/Footer.js","libs/SubscriptionManager.ts","globals.js","libs/StorageManager.ts","libs/GitHub.js","components/Dialog.js","libs/model.js","libs/css-utils.js","components/CodeArea.js","libs/ui-model.js","components/File.js","components/Files.js","components/Log.js","components/Runner.js","components/Layout3Vertical.js","components/Layout3Horizontal.js","libs/utils.ts","components/Layout2x2.js","components/LayoutTabbed.js","components/IDE.js","libs/gists.js","components/LoadGist.tsx","libs/compression.js","libs/OAuthManager.ts","icons/vertical-layout.svg","icons/horizontal-layout.svg","icons/two-by-two-layout.svg","icons/tabbed-layout.svg"],"names":["parent","document","createElement","setAttribute","classList","add","child","appendChild","body","firstChild","clientWidth","removeChild","EditLine","props","type","onChange","e","target","value","placeholder","darkMatcher","window","matchMedia","noop","Code","registerEditor","editor","hackKey","state","registerAPI","this","goToLine","lineNo","colNo","focus","doc","setCursor","refresh","_","options","onValueChange","isDarkMode","matches","codeMirrorOptions","mode","scrollbarStyle","theme","matchBrackets","lineNumbers","indexOf","matchTags","onBeforeChange","data","setState","editorDidMount","React","Component","ServiceContext","createContext","createURL","base","params","url","URL","searchParams","URLSearchParams","search","Object","entries","key","undefined","delete","set","toString","href","nullHandlers","Map","fromToHandlersMap","on","from","fn","remove","handlers","get","fns","push","ndx","splice","length","size","callHandler","addEventListener","source","helperUrl","location","origin","Preview","handleSendPreview","iframeRef","current","contentWindow","postMessage","handleResize","style","height","createRef","show","winMsgMgr","preview","title","ref","src","GistComment","onUserStatusChange","forceUpdate","handleOnChange","tab","handleSaveComment","a","context","github","addError","gistId","addComment","createGistComment","previewKey","message","userManager","subscribe","unsubscribe","userData","getUserData","showPreview","className","login","rel","avatar_url","alt","name","id","checked","htmlFor","display","onClick","renderCommentForm","renderLogin","contextType","GistComments","nextProps","disqusId","gist_id","gitUserId","SubscriptionManager","itemToSubscriptionMap","item","slice","storageManager","prefix","subscriptionManager","_handleNewValue","startsWith","unPrefixedKey","substr","notify","session","k","_addPrefix","v","sessionStorage","getItem","localStorage","setItem","removeItem","removeEventListener","emptyValue","getEmptyFileHack","file","content","getGistContent","gist","JSON","parse","files","filenames","map","filter","concat","createGistData","secret","reduce","trim","saveData","jsGistData","keys","stringify","lowerCaseFiles","n","toLowerCase","includes","filename","description","public","EventTarget","validator","Ajv","compile","schema","trackedValues","getValueOrMakeNew","trackedValue","subscriptions","Set","initialValue","newValue","Error","newTestData","incVersion","incDataVersion","incFilesVersion","setFileName","newName","setFileContent","setData","newData","errors","dataPath","validate","camelCaseRE","toDash","left","right","camelCaseToDash","s","replace","classNames","names","args","arg","join","CodeArea","heading","extra","settings","File","handleRegisterAPI","api","codeAPI","register","section","unregister","width","mimeType","mime","lookup","initialized","json","model","layout","screen","init","uiStateValidator","Files","onSetSizes","sizes","uiModel","kUIStateKey","handleRegister","handleUnregister","fileToKeyMap","uiStateKey","i","test","Date","now","Math","random","forEach","direction","minSize","computeNewSizesFn","moveGuttersComputeNewSizes","getFileKey","desc","onTitleChange","Log","handleChange","logMessagesRef","logManager","prevProps","prevState","snapshot","elem","scrollTop","scrollHeight","parentElement","clientHeight","onGoToLine","getMsgs","msg","tooltip","count","fileLink","data-tooltip","lastIndexOf","basename","Runner","handleJSLog","addMsg","handleJSError","showStack","handleJSUnhandledRejection","handleInfoMessages","addMsgs","handleGimmeDaCodez","iframe","handleMessage","runnerRef","run","blank","removeIFrame","background","Layout3Vertical","onSetVSizes","vSizes","onSetHSizes","hSizes","registerFilesAPI","filesAPI","handleGoToLine","registerRunnerAPI","Layout3Horizontal","onSetTSizes","tSizes","onSetBSizes","bSizes","findNdx","endings","ending","findIndex","endsWith","getOrFindNdx","f","NamedFile","Layout2x2","onSetV1Sizes","v1Sizes","onSetV2Sizes","v2Sizes","mainHTMLNdx","mainJSNdx","mainCSSNdx","fixSizes","lastSizes","oldSize","availableSpace","len","sum","newSizes","layoutModes","setSizes","currentNdx","showResult","showLow","toggleShowLog","showLog","toggleShowResult","previousNdx","resultStyle","logStyle","Fragment","gistSchema","gistsSchema","ajv","gistsValidator","gistValidator","getStoredGists","gists","removeGist","saveGistsToLocalStorage","setGists","gistsToSortedArray","checks","sortKey","sortDir","compareDirMult","compFn","b","date","ap","bp","sign","has","getSortFn","console","log","sort","SortBy","selected","update","LoadGist","handleNewGists","toggleCheck","loadGists","updateSort","loading","getUserGists","gistArray","updated_at","deleteSelected","_gists","ids","deleteGist","clearBackup","backupManager","canLoad","disabled","dir","substring","matchFilter","encodeURIComponent","renderLoad","TextEncoder","TextDecoder","module","exports"],"mappings":"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","file":"static/js/main.b892e844.chunk.js","sourcesContent":["import './scrollbars.css';\n\n/*\n * Scrollbar Width Test\n * Adds `layout-scrollbar-obtrusive` class to body if scrollbars use up screen real estate\n */\nconst parent = document.createElement(\"div\");\nparent.setAttribute(\"style\", \"width:30px;height:30px;\");\nparent.classList.add('scrollbar-test');\n\nconst child = document.createElement(\"div\");\nchild.setAttribute(\"style\", \"width:100%;height:40px\");\nparent.appendChild(child);\ndocument.body.appendChild(parent);\n\n// Measure the child element, if it is not\n// 30px wide the scrollbars are obtrusive.\nconst scrollbarWidth = 30 - parent.firstChild.clientWidth;\nif(scrollbarWidth) {\n  document.body.classList.add(\"layout-scrollbar-obtrusive\");\n}\n\ndocument.body.removeChild(parent);","import React from 'react';\n\nexport default function EditLine(props) {\n  return (\n    <input\n      type=\"text\"\n      onChange={(e) => {props.onChange(e.target.value)}}\n      placeholder={props.placeholder}\n      value={props.value} />\n  );\n}","import React from 'react';\nimport {Controlled as CodeMirror} from 'react-codemirror2';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/theme/eclipse.css';\nimport 'codemirror/mode/css/css.js';\nimport 'codemirror/mode/gfm/gfm.js';\nimport 'codemirror/mode/htmlmixed/htmlmixed.js';\nimport 'codemirror/mode/javascript/javascript.js';\nimport 'codemirror/addon/scroll/simplescrollbars.js';\nimport 'codemirror/addon/scroll/simplescrollbars.css';\nimport 'codemirror/addon/search/search.js';\nimport 'codemirror/addon/search/searchcursor.js';\nimport 'codemirror/addon/search/jump-to-line.js';\nimport 'codemirror/addon/dialog/dialog.js';\nimport 'codemirror/addon/dialog/dialog.css';\nimport 'codemirror/addon/edit/matchbrackets.js';\nimport 'codemirror/addon/edit/matchtags.js';\nimport 'codemirror/addon/fold/xml-fold.js';\n\nconst darkMatcher = window.matchMedia\n    ? window.matchMedia('(prefers-color-scheme: dark)')\n    : {};\n// darkMatcher.addListener(render);\n\nconst noop = () => {};\n\nexport default class Code extends React.Component {\n  constructor(props) {\n    super(props);\n    const {value, hackKey} = props;\n    this.state = {value, hackKey}\n  }\n  static getDerivedStateFromProps(props, state) {\n    const needNewData = state.hackKey !== props.hackKey;\n    return (needNewData)\n       ? {hackKey: props.hackKey, value: props.value}\n       : null;\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n    if (registerAPI) {\n      registerAPI({\n        goToLine: (lineNo, colNo) => {\n          this.editor.focus();\n          this.editor.doc.setCursor(lineNo - 1, colNo - 1);\n        },\n        refresh: _ => {\n          this.editor.refresh();\n        },\n        focus: _ => {\n          this.editor.focus();\n        },\n      });\n    }\n  }\n  registerEditor = (editor) => {\n    this.editor = editor;\n  }\n  render() {\n    const {options = {}, onValueChange = noop} = this.props;\n    const {value} =  this.state;\n    const isDarkMode = darkMatcher.matches;\n    const codeMirrorOptions = {\n      mode: 'javascript',\n      scrollbarStyle: 'overlay',\n      theme: isDarkMode ? 'material' : 'eclipse',\n      matchBrackets: true,\n      lineNumbers: true,\n      ...(options.editor && options.editor),\n    };\n    if (codeMirrorOptions.mode.indexOf('html') >= 0) {\n      codeMirrorOptions.matchTags = true;\n    }\n    return (\n      <CodeMirror\n        value={value}\n        options={codeMirrorOptions}\n        onBeforeChange={(editor, data, value) => {\n          this.setState({value});\n        }}\n        onChange={(editor, data, value) => {\n          onValueChange(value);\n        }}\n        editorDidMount={this.registerEditor}\n      />\n    );\n  }\n};\n","import React from 'react';\n\nconst ServiceContext = React.createContext();\nexport default ServiceContext;\n","export function createURL(base, params) {\n  const url = new URL(base);\n  const searchParams = new URLSearchParams(url.search);\n  for (const [key, value] of Object.entries(params)) {\n    if (value === undefined) {\n      searchParams.delete(key);\n    } else {\n      searchParams.set(key, value);\n    }\n  }\n  url.search = searchParams.toString();\n  return url.href;\n}\n\nexport function updateURL(params) {\n  const url = createURL(window.location.href, params);\n  window.history.replaceState({}, '', url.href);\n}\n\n","type Handler = (data: any) => void;\ntype StringToHandlers = Map<string, Handler[]>;\nconst nullHandlers : StringToHandlers = new Map();\nconst fromToHandlersMap : Map<Window | null, StringToHandlers> = new Map([[null, nullHandlers]]);\n\nexport function on(type: string, from: Window | null, fn: (data: any) => void) {\n  remove(type, from, fn);\n  let handlers = fromToHandlersMap.get(from);\n  if (!handlers) {\n    handlers = new Map();\n    fromToHandlersMap.set(from, handlers)\n  }\n  let fns = handlers.get(type);\n  if (!fns) {\n    fns = [];\n    handlers.set(type, fns);\n  }\n  fns.push(fn);\n}\n\nexport function remove(type: string, from: Window | null, fn: (data: any) => void) {\n  let handlers = fromToHandlersMap.get(from);\n  if (!handlers) {\n    return;\n  }\n  const fns = handlers.get(type);\n  if (fns) {\n    const ndx = fns.indexOf(fn);\n    if (ndx >= 0) {\n      fns.splice(ndx, 1);\n    }\n    if (fns.length === 0) {\n      handlers.delete(type);\n      if (handlers.size === 0 && from) {\n        fromToHandlersMap.delete(from);\n      }\n    }\n  }\n}\n\nfunction callHandler(handlers: StringToHandlers, type: string, data: any) {\n  const fns = handlers.get(type);\n  if (fns) {\n    for (const fn of fns) {\n      fn(data);\n    }\n    return true;\n  }\n  return false;\n}\n\nwindow.addEventListener('message', (e: MessageEvent) => {\n  const {type, data} = e.data;\n  const handlers = fromToHandlersMap.get(e.source as Window);\n  if (handlers) {\n    if (callHandler(handlers, type, data)) {\n      return;\n    }\n  }\n  callHandler(nullHandlers, type, data);\n});\n\n","import React from 'react';\n\nimport Code from './Code.js';\nimport {isDevelopment} from '../libs/flags.js';\nimport ServiceContext from '../ServiceContext.js';\nimport {createURL} from '../libs/url.js';\nimport * as winMsgMgr from '../libs/WindowMessageManager';\n\nconst helperUrl = isDevelopment\n    ? 'http://localhost:8080/gist-comments.js'\n    : `${window.location.origin}/gist-comments.js`;\n\nclass Preview extends React.Component {\n  constructor(props) {\n    super(props);\n    this.iframeRef = React.createRef();\n    this.show = props.show;\n  }\n  handleSendPreview = () => {\n    const {body} = this.props;\n    this.iframeRef.current.contentWindow.postMessage({type: 'preview', data: {body}}, '*');\n  }\n  handleResize = (data) => {\n    this.iframeRef.current.style.height = `${data.height}px`;\n  }\n  componentDidMount() {\n    winMsgMgr.on('sendPreview', this.iframeRef.current.contentWindow, this.handleSendPreview);\n    winMsgMgr.on('resize', this.iframeRef.current.contentWindow, this.handleResize);\n  }\n  componentDidUpdate() {\n    if (this.props.show !== this.show) {\n      this.show = this.props.show;\n      if (this.show) {\n        this.handleSendPreview();\n      }\n    }\n  }\n  componentWillUnmount() {\n    winMsgMgr.remove('sendPreview', this.iframeRef.current.contentWindow, this.handleSendPreview);\n    winMsgMgr.remove('resize', this.iframeRef.current.contentWindow, this.handleResize);\n  }\n  render() {\n    const url = createURL('https://jsgist.devcomments.org/gist-comments.html', {preview: true, url: helperUrl});\n    return (\n      <iframe title=\"comment-preview\" ref={this.iframeRef} src={url} />\n    );\n  }\n}\n\nexport default class GistComment extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: isDevelopment ? `# this is a test\n\n\\`\\`\\`js\nconst a = b + c;\n\\`\\`\\`\n\nfoo *bar* **moo** \\`code\\` etc...\n\n1. this\n2. that\n3. other\n\n* banana\n* apple\n* grape\n\n\\`\\`\\`html\n<div>some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling some long line that needs scrolling </div>\n\\`\\`\\`\n` : '',\n      tab: 0,\n      previewKey: 1,\n    };\n  }\n  onUserStatusChange = () => {\n    this.forceUpdate();\n  }\n  componentDidMount() {\n    const {userManager} = this.context;\n    userManager.subscribe(this.onUserStatusChange);\n  }\n  componentWillUnmount() {\n    const {userManager} = this.context;\n    userManager.unsubscribe(this.onUserStatusChange);\n  }\n  onValueChange = (value) => {\n    this.setState({value});\n  }\n  handleOnChange = (tab) => {\n    this.setState({tab});\n  }\n  handleSaveComment = async() => {\n    const {github, addError} = this.context;\n    try {\n      const {gistId, addComment} = this.props;\n      const data = await github.createGistComment(gistId, this.state.value);\n      this.setState({\n        value: '',\n        previewKey: this.state.previewKey + 1,\n      });\n      addComment(data);\n    } catch (e) {\n      addError(e.message || e);\n    }\n  }\n  renderCommentForm() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    const {\n      value,\n      tab,\n      previewKey,\n    } = this.state;\n    const options = {\n      editor: {\n        mode: 'gfm',\n        lineNumbers: false,\n      },\n    };\n    const showPreview = tab === 1;\n    return (\n      <div className=\"new-comment\">\n        <div className=\"new-comment-head\">\n          {!!userData.login && <div className=\"username\"><a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.login}`}>{userData.login}</a></div>}\n          {!!userData.avatar_url && <a className=\"user-avatar\" target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/${userData.login}`}><img className=\"avatar\" src={userData.avatar_url} alt=\"avatar\"/></a>}\n        </div>\n        <div className=\"new-comment-tabs\">\n          <input\n            type=\"radio\"\n            name=\"new-comment\"\n            id=\"write\"\n            checked={tab === 0}\n            onChange={_ => this.handleOnChange(0)}\n          />\n          <label htmlFor=\"write\">write</label>\n          <input\n            type=\"radio\"\n            name=\"new-comment\"\n            id=\"preview\"\n            checked={tab === 1}\n            onChange={_ => this.handleOnChange(1)}\n          />\n          <label htmlFor=\"preview\">preview</label>\n        </div>\n        <div className=\"new-comment-content\">\n          <div style={{...(tab === 1 && {display: 'none'})}} className=\"new-comment-write\">\n            <Code\n              hackKey={previewKey}\n              value={value}\n              options={options}\n              onValueChange={this.onValueChange}\n              registerAPI={_ => _}\n            />\n          </div>\n          <div className=\"new-comment-preview\" style={{...(!showPreview && {display: 'none'})}}>\n            <Preview key={previewKey} body={value} show={showPreview} />\n          </div>\n        </div>\n        <div className=\"new-comment-submit  \">\n          <button onClick={this.handleSaveComment}>Comment</button>\n        </div>\n      </div>\n    );\n  }\n  renderLogin() {\n    const {userManager} = this.context;\n    return (\n      <div className=\"new-comment\">\n        <button\n          onClick={userManager.login}\n        >Login with github</button>\n      </div>\n    )\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return (userData\n      ? this.renderCommentForm()\n      : this.renderLogin()\n    );\n  }\n}\n\nGistComment.contextType = ServiceContext;\n","import React from 'react';\n\nimport {isDevelopment} from '../libs/flags.js';\nimport ServiceContext from '../ServiceContext.js';\nimport {createURL} from '../libs/url.js';\nimport * as winMsgMgr from '../libs/WindowMessageManager';\n\nconst helperUrl = isDevelopment\n    ? 'http://localhost:8080/gist-comments.js'\n    : `${window.location.origin}/gist-comments.js`;\n\n\n// Comments are served from a separate domain in an iframe.\n// This is because comments have user data that is turned\n// into HTML. Of course we should sanitize but if we have\n// a bug we can't let it be on our page directly\n// otherwise it could read our secrets\n//\nexport default class GistComments extends React.Component {\n  constructor() {\n    super();\n    this.iframeRef = React.createRef();\n  }\n  // Our script creates an iframe and the content in the iframe\n  // communicates back to the main page to tell it the size of the content\n  // so the main page can adjust the iframe size.\n  handleResize = (data) => {\n    this.iframeRef.current.style.height = `${data.height}px`;\n  }\n  addComment = (data) => {\n    this.iframeRef.current.contentWindow.postMessage({\n      type: 'addComment',\n      data,\n    }, '*');\n  }\n  componentDidMount() {\n    winMsgMgr.on('resize', this.iframeRef.current.contentWindow, this.handleResize);\n    this.props.registerAPI({\n      addComment: this.addComment,\n    });\n  }\n  componentWillUnmount() {\n    winMsgMgr.remove('resize', this.iframeRef.current.contentWindow, this.handleResize);\n  }\n  shouldComponentUpdate(nextProps) {\n    return nextProps.disqusId !== this.disqusId;\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData() || {};\n    const {gistId} = this.props;\n    const url = createURL('https://jsgist.devcomments.org/gist-comments.html', {gist_id: gistId, url: helperUrl, gitUserId: userData.id});\n    return (\n      <div>\n        { !!gistId &&\n          <iframe\n            ref={this.iframeRef}\n            title=\"comments\"\n            src={url}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nGistComments.contextType = ServiceContext;\n","\nimport React from 'react';\nimport GistComment from './GistComment.js';\nimport GistComments from './GistComments.js';\n\nexport default class Footer extends React.Component {\n  registerAPI = (api) => {\n    this.api = api;\n  }\n  addComment = (data) => {\n    this.api.addComment(data);\n  }\n  render() {\n    const {gistId, title} = this.props;\n    return (\n      <div className=\"comments\">\n        <hr/>\n        {\n          gistId &&\n            <React.Fragment>\n              <GistComments gistId={gistId} title={title} registerAPI={this.registerAPI} />\n              <GistComment gistId={gistId} addComment={this.addComment} />\n            </React.Fragment>\n        }\n      </div>\n    );\n  }\n}","\nexport default class SubscriptionManager {\n  itemToSubscriptionMap: Map<string, (() => void)[]>;\n  constructor() {\n    this.itemToSubscriptionMap = new Map();\n  }\n  subscribe(item: string, fn: () => void) {\n    this.unsubscribe(item, fn);\n    let fns = this.itemToSubscriptionMap.get(item);\n    if (!fns) {\n      fns = [];\n      this.itemToSubscriptionMap.set(item, fns);\n    }\n    fns.push(fn);\n  }\n  unsubscribe(item: string, fn: () => void): void {\n    const fns = this.itemToSubscriptionMap.get(item);\n    if (fns) {\n      const ndx = fns.indexOf(fn);\n      if (ndx >= 0) {\n        fns.splice(ndx, 1);\n        if (fns.length === 0) {\n          this.itemToSubscriptionMap.delete(item);\n        }\n      }\n    }\n  }\n  notify(item: string): void {\n    const fns = this.itemToSubscriptionMap.get(item);\n    if (fns) {\n      for (const fn of fns.slice()) {\n        fn();\n      }\n    }\n  }\n}","import StorageManager from './libs/StorageManager';\nimport {isDevelopment} from './libs/flags.js';\n\nexport const storageManager = new StorageManager('jsgist');\nexport const clientId = isDevelopment\n    ? 'b7822ff167d2bbe9a361'\n    : 'c055b54872b13c10e4bd';\n\n","import SubscriptionManager from './SubscriptionManager';\n\nexport default class StorageManager {\n  prefix: string;\n  subscriptionManager: SubscriptionManager;\n\n  constructor(prefix: string) {\n    this.prefix = `${prefix}-`;\n    this.subscriptionManager = new SubscriptionManager();\n    window.addEventListener('storage', this._handleNewValue);\n  }\n  private _handleNewValue = (e: StorageEvent) => {\n    const key = e.key;\n    if (key && key.startsWith(this.prefix)) {\n      const unPrefixedKey = key.substr(this.prefix.length);\n      this.subscriptionManager.notify(unPrefixedKey);\n    }\n  }\n  private _addPrefix(key: string): string {\n    return `${this.prefix}${key}`;\n  }\n  subscribe(key: string, fn: () => void): void {\n    this.subscriptionManager.subscribe(key, fn);\n  }\n  unsubscribe(key: string, fn: () => void): void {\n    this.subscriptionManager.unsubscribe(key, fn);\n  }\n  get(key: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      const v = sessionStorage.getItem(k);\n      if (v) {\n        return v;\n      }\n    }\n    return localStorage.getItem(k);\n  }\n  set(key: string, value: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      sessionStorage.setItem(k, value);\n    }\n    localStorage.setItem(k, value);\n    this.subscriptionManager.notify(key);\n  }\n  delete(key: string, session = false) {\n    const k = this._addPrefix(key);\n    if (session) {\n      sessionStorage.removeItem(k);\n    }\n    localStorage.removeItem(k);\n    this.subscriptionManager.notify(key);\n  }\n  cleanup() {\n    window.removeEventListener('storage', this._handleNewValue);\n  }\n}\n","import { Octokit } from '@octokit/rest';\n\nconst userAgent = 'jsGist v0.0.1';\nconst emptyValue = '/*bug-in-github-api-content-can-not-be-empty*/';\n\nfunction getEmptyFileHack(file) {\n  return file.content.startsWith(emptyValue)\n                ? file.content.substr(emptyValue.length)\n                : file.content;\n}\n\n// there are 3 forms current\n//\n// 1. files are stored by filename (legacy)\n// 2. files are stored as JSON (this happens if there are any duplicate names)\n// 3. files are stored by filename and filenames references them in order\n\nexport function getGistContent(gist) {\n  const data = JSON.parse(gist.files['jsGist.json'].content);\n  // github stores files by filename but we need them in the same order in the array\n  // they started with so they go to the correct pane.\n  if (data.filenames) {\n    data.files = data.filenames.map(name => {\n      return {\n        name: name,\n        content: getEmptyFileHack(gist.files[name]),\n      };\n    });\n  } else {\n    // legacy path if there are no filenames\n    data.files = Object.entries(gist.files)\n      .filter(([name]) => name !== 'jsGist.json')\n      .map(([name, file]) => {\n        return {\n          name,\n          content: getEmptyFileHack(file),\n        }\n      }).concat(data.files || []);\n  }\n  return data;\n} \n\n/*\n  \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9\",\n  \"forks_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/forks\",\n  \"commits_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/commits\",\n  \"id\": \"bad0a8491bd6614e729ff01cc14089c9\",\n  \"node_id\": \"MDQ6R2lzdGJhZDBhODQ5MWJkNjYxNGU3MjlmZjAxY2MxNDA4OWM5\",\n  \"git_pull_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9.git\",\n  \"git_push_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9.git\",\n  \"html_url\": \"https://gist.github.com/bad0a8491bd6614e729ff01cc14089c9\",\n  \"files\": {\n    \"index.css\": {\n      \"filename\": \"index.css\",\n      \"type\": \"text/css\",\n      \"language\": \"CSS\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/1847e2c75f6b76223402f69bada71e72db880605/index.css\",\n      \"size\": 243,\n      \"truncated\": false,\n      \"content\": \"body {\\n  margin: 0;\\n}\\n#c {\\n  width: 100vw;\\n  height: 100vh;\\n  display: block;\\n}\\n#info { \\n  position: absolute; \\n  left: 1em; \\n  top: 1em; \\n  background: rgba(0,0,0,.8); \\n  padding: .5em;\\n        color: white;\\n        font-family: monospace;\\n}\\n\"\n    },\n    \"index.html\": {\n      \"filename\": \"index.html\",\n      \"type\": \"text/html\",\n      \"language\": \"HTML\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/c9e9e838f601e2d98d448b035ce3052629969c11/index.html\",\n      \"size\": 46,\n      \"truncated\": false,\n      \"content\": \"<canvas id=\\\"c\\\"></canvas>\\n<div id=\\\"info\\\"></div>\"\n    },\n    \"index.js\": {\n      \"filename\": \"index.js\",\n      \"type\": \"application/javascript\",\n      \"language\": \"JavaScript\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/77a7fca481ff157da44f4196ce253ea282f0abdc/index.js\",\n      \"size\": 8413,\n      \"truncated\": false,\n      \"content\": \"import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';\\n\\nfunction main() {\\n  const canvas = document.querySelector('#c');\\n  const renderer = new THREE.WebGLRenderer({canvas: canvas});\\n  renderer.setClearColor(0x88AACC);\\n  renderer.shadowMap.enabled = true;\\n\\n  function makeCamera(fov = 40) {\\n    const aspect = 2;  // the canvas default\\n    const zNear = 0.1;\\n    const zFar = 1000;\\n    return new THREE.PerspectiveCamera(fov, aspect, zNear, zFar);\\n  }\\n  const camera = makeCamera();\\n  camera.position.set(8, 4, 10).multiplyScalar(3);\\n  camera.lookAt(0, 0, 0);\\n\\n  const scene = new THREE.Scene();\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(0, 20, 0);\\n    scene.add(light);\\n    light.castShadow = true;\\n    light.shadow.mapSize.width = 2048;\\n    light.shadow.mapSize.height = 2048;\\n\\n    const d = 50;\\n    light.shadow.camera.left = -d;\\n    light.shadow.camera.right = d;\\n    light.shadow.camera.top = d;\\n    light.shadow.camera.bottom = -d;\\n    light.shadow.camera.near = 1;\\n    light.shadow.camera.far = 50;\\n    light.shadow.bias = 0.001;\\n  }\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(1, 2, 4);\\n    scene.add(light);\\n  }\\n\\n  const groundGeometry = new THREE.PlaneBufferGeometry(50, 50);\\n  const groundMaterial = new THREE.MeshPhongMaterial({color: 0xCC8866});\\n  const groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\\n  groundMesh.rotation.x = Math.PI * -.5;\\n  groundMesh.receiveShadow = true;\\n  scene.add(groundMesh);\\n\\n  const carWidth = 4;\\n  const carHeight = 1;\\n  const carLength = 8;\\n\\n  const tank = new THREE.Object3D();\\n  scene.add(tank);\\n\\n  const bodyGeometry = new THREE.BoxBufferGeometry(carWidth, carHeight, carLength);\\n  const bodyMaterial = new THREE.MeshPhongMaterial({color: 0x66AA88});\\n  const bodyMesh = new THREE.Mesh(bodyGeometry, bodyMaterial);\\n  bodyMesh.position.y = 1.4;\\n  bodyMesh.castShadow = true;\\n  tank.add(bodyMesh);\\n\\n  const tankCameraFov = 75;\\n  const tankCamera = makeCamera(tankCameraFov);\\n  tankCamera.position.y = 3;\\n  tankCamera.position.z = -6;\\n  tankCamera.rotation.y = Math.PI;\\n  bodyMesh.add(tankCamera);\\n\\n  const wheelRadius = 1;\\n  const wheelThickness = .5;\\n  const wheelSegments = 6;\\n  const wheelGeometry = new THREE.CylinderBufferGeometry(\\n      wheelRadius,     // top radius\\n      wheelRadius,     // bottom radius\\n      wheelThickness,  // height of cylinder\\n      wheelSegments);\\n  const wheelMaterial = new THREE.MeshPhongMaterial({color: 0x888888});\\n  const wheelPositions = [\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, 0],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, 0],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n  ];\\n  const wheelMeshes = wheelPositions.map((position) => {\\n    const mesh = new THREE.Mesh(wheelGeometry, wheelMaterial);\\n    mesh.position.set(...position);\\n    mesh.rotation.z = Math.PI * .5;\\n    mesh.castShadow = true;\\n    bodyMesh.add(mesh);\\n    return mesh;\\n  });\\n\\n  const domeRadius = 2;\\n  const domeWidthSubdivisions = 12;\\n  const domeHeightSubdivisions = 12;\\n  const domePhiStart = 0;\\n  const domePhiEnd = Math.PI * 2;\\n  const domeThetaStart = 0;\\n  const domeThetaEnd = Math.PI * .5;\\n  const domeGeometry = new THREE.SphereBufferGeometry(\\n    domeRadius, domeWidthSubdivisions, domeHeightSubdivisions,\\n    domePhiStart, domePhiEnd, domeThetaStart, domeThetaEnd);\\n  const domeMesh = new THREE.Mesh(domeGeometry, bodyMaterial);\\n  domeMesh.castShadow = true;\\n  bodyMesh.add(domeMesh);\\n  domeMesh.position.y = .5;\\n\\n  const turretWidth = .1;\\n  const turretHeight = .1;\\n  const turretLength = carLength * .75 * .2;\\n  const turretGeometry = new THREE.BoxBufferGeometry(\\n      turretWidth, turretHeight, turretLength);\\n  const turretMesh = new THREE.Mesh(turretGeometry, bodyMaterial);\\n  const turretPivot = new THREE.Object3D();\\n  turretMesh.castShadow = true;\\n  turretPivot.scale.set(5, 5, 5);\\n  turretPivot.position.y = .5;\\n  turretMesh.position.z = turretLength * .5;\\n  turretPivot.add(turretMesh);\\n  bodyMesh.add(turretPivot);\\n\\n  const turretCamera = makeCamera();\\n  turretCamera.position.y = .75 * .2;\\n  turretMesh.add(turretCamera);\\n\\n  const targetGeometry = new THREE.SphereBufferGeometry(.5, 6, 3);\\n  const targetMaterial = new THREE.MeshPhongMaterial({color: 0x00FF00, flatShading: true});\\n  const targetMesh = new THREE.Mesh(targetGeometry, targetMaterial);\\n  const targetOrbit = new THREE.Object3D();\\n  const targetElevation = new THREE.Object3D();\\n  const targetBob = new THREE.Object3D();\\n  targetMesh.castShadow = true;\\n  scene.add(targetOrbit);\\n  targetOrbit.add(targetElevation);\\n  targetElevation.position.z = carLength * 2;\\n  targetElevation.position.y = 8;\\n  targetElevation.add(targetBob);\\n  targetBob.add(targetMesh);\\n\\n  const targetCamera = makeCamera();\\n  const targetCameraPivot = new THREE.Object3D();\\n  targetCamera.position.y = 1;\\n  targetCamera.position.z = -2;\\n  targetCamera.rotation.y = Math.PI;\\n  targetBob.add(targetCameraPivot);\\n  targetCameraPivot.add(targetCamera);\\n\\n  // Create a sine-like wave\\n  const curve = new THREE.SplineCurve( [\\n    new THREE.Vector2( -10, 0 ),\\n    new THREE.Vector2( -5, 5 ),\\n    new THREE.Vector2( 0, 0 ),\\n    new THREE.Vector2( 5, -5 ),\\n    new THREE.Vector2( 10, 0 ),\\n    new THREE.Vector2( 5, 10 ),\\n    new THREE.Vector2( -5, 10 ),\\n    new THREE.Vector2( -10, -10 ),\\n    new THREE.Vector2( -15, -8 ),\\n    new THREE.Vector2( -10, 0 ),\\n  ] );\\n\\n  const points = curve.getPoints( 50 );\\n  const geometry = new THREE.BufferGeometry().setFromPoints( points );\\n  const material = new THREE.LineBasicMaterial( { color : 0xff0000 } );\\n  const splineObject = new THREE.Line( geometry, material );\\n  splineObject.rotation.x = Math.PI * .5;\\n  splineObject.position.y = 0.05;\\n  scene.add(splineObject);\\n\\n  function resizeRendererToDisplaySize(renderer) {\\n    const canvas = renderer.domElement;\\n    const width = canvas.clientWidth;\\n    const height = canvas.clientHeight;\\n    const needResize = canvas.width !== width || canvas.height !== height;\\n    if (needResize) {\\n      renderer.setSize(width, height, false);\\n    }\\n    return needResize;\\n  }\\n\\n  const targetPosition = new THREE.Vector3();\\n  const tankPosition = new THREE.Vector2();\\n  const tankTarget = new THREE.Vector2();\\n\\n  const cameras = [\\n    { cam: camera, desc: 'detached camera', },\\n    { cam: turretCamera, desc: 'on turret looking at target', },\\n    { cam: targetCamera, desc: 'near target looking at tank', },\\n    { cam: tankCamera, desc: 'above back of tank', },\\n  ];\\n\\n  const infoElem = document.querySelector('#info');\\n\\n  function render(time) {\\n    time *= 0.001;\\n\\n    if (resizeRendererToDisplaySize(renderer)) {\\n      const canvas = renderer.domElement;\\n      cameras.forEach((cameraInfo) => {\\n        const camera = cameraInfo.cam;\\n        camera.aspect = canvas.clientWidth / canvas.clientHeight;\\n        camera.updateProjectionMatrix();\\n      });\\n    }\\n\\n    // move target\\n    targetOrbit.rotation.y = time * .27;\\n    targetBob.position.y = Math.sin(time * 2) * 4;\\n    targetMesh.rotation.x = time * 7;\\n    targetMesh.rotation.y = time * 13;\\n    targetMaterial.emissive.setHSL(time * 10 % 1, 1, .25);\\n    targetMaterial.color.setHSL(time * 10 % 1, 1, .25);\\n\\n    // move tank\\n    const tankTime = time * .05;\\n    curve.getPointAt(tankTime % 1, tankPosition);\\n    curve.getPointAt((tankTime + 0.01) % 1, tankTarget);\\n    tank.position.set(tankPosition.x, 0, tankPosition.y);\\n    tank.lookAt(tankTarget.x, 0, tankTarget.y);\\n\\n    // face turret at target\\n    targetMesh.getWorldPosition(targetPosition);\\n    turretPivot.lookAt(targetPosition);\\n\\n    // make the turretCamera look at target\\n    turretCamera.lookAt(targetPosition);\\n\\n    // make the targetCameraPivot look at the at the tank\\n    tank.getWorldPosition(targetPosition);\\n    targetCameraPivot.lookAt(targetPosition);\\n\\n    wheelMeshes.forEach((obj) => {\\n      obj.rotation.x = time * 3;\\n    });\\n\\n    const camera = cameras[time * .25 % cameras.length | 0];\\n    infoElem.textContent = camera.desc;\\n\\n    renderer.render(scene, camera.cam);\\n\\n    requestAnimationFrame(render);\\n  }\\n\\n  requestAnimationFrame(render);\\n}\\n\\nmain();\\n\"\n    },\n    \"jsGist.json\": {\n      \"filename\": \"jsGist.json\",\n      \"type\": \"application/json\",\n      \"language\": \"JSON\",\n      \"raw_url\": \"https://gist.githubusercontent.com/greggman/bad0a8491bd6614e729ff01cc14089c9/raw/ac014ca1eb788c3c05b1612902b142f59fca3f7c/jsGist.json\",\n      \"size\": 60,\n      \"truncated\": false,\n      \"content\": \"{\\\"name\\\":\\\"ThreeJSFundamentals Scenegraph Tank\\\",\\\"settings\\\":{}}\"\n    }\n  },\n  \"public\": true,\n  \"created_at\": \"2020-10-11T08:16:53Z\",\n  \"updated_at\": \"2020-11-04T17:41:21Z\",\n  \"description\": \"ThreeJSFundamentals Scenegraph Tank\",\n  \"comments\": 9,\n  \"user\": null,\n  \"comments_url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/comments\",\n  \"owner\": {\n    \"login\": \"greggman\",\n    \"id\": 234804,\n    \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n    \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n    \"gravatar_id\": \"\",\n    \"url\": \"https://api.github.com/users/greggman\",\n    \"html_url\": \"https://github.com/greggman\",\n    \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n    \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n    \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n    \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n    \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n    \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n    \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n    \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n    \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n    \"type\": \"User\",\n    \"site_admin\": false\n  },\n  \"forks\": [\n\n  ],\n  \"history\": [\n    {\n      \"user\": {\n        \"login\": \"greggman\",\n        \"id\": 234804,\n        \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n        \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n        \"gravatar_id\": \"\",\n        \"url\": \"https://api.github.com/users/greggman\",\n        \"html_url\": \"https://github.com/greggman\",\n        \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n        \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n        \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n        \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n        \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n        \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n        \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n        \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n        \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n        \"type\": \"User\",\n        \"site_admin\": false\n      },\n      \"version\": \"fcbedffeccec982c99bc3963ed77f41762a8dd5a\",\n      \"committed_at\": \"2020-10-17T02:08:28Z\",\n      \"change_status\": {\n        \"total\": 4,\n        \"additions\": 2,\n        \"deletions\": 2\n      },\n      \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/fcbedffeccec982c99bc3963ed77f41762a8dd5a\"\n    },\n    {\n      \"user\": {\n        \"login\": \"greggman\",\n        \"id\": 234804,\n        \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n        \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n        \"gravatar_id\": \"\",\n        \"url\": \"https://api.github.com/users/greggman\",\n        \"html_url\": \"https://github.com/greggman\",\n        \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n        \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n        \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n        \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n        \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n        \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n        \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n        \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n        \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n        \"type\": \"User\",\n        \"site_admin\": false\n      },\n      \"version\": \"16bda36d8000991414a7240edaf7f5aa709183af\",\n      \"committed_at\": \"2020-10-11T08:16:53Z\",\n      \"change_status\": {\n        \"total\": 273,\n        \"additions\": 273,\n        \"deletions\": 0\n      },\n      \"url\": \"https://api.github.com/gists/bad0a8491bd6614e729ff01cc14089c9/16bda36d8000991414a7240edaf7f5aa709183af\"\n    }\n  ],\n  \"truncated\": false\n}\n*/\nexport async function getAnonGist(gist_id) {\n  const req = await fetch(`https://api.github.com/gists/${gist_id}`);\n  const gist = await req.json();\n  return {\n    data: getGistContent(gist),\n    rawData: gist,\n  };\n}\n\nexport function getUserData(data) {\n  return (data && data.owner)\n      ? {\n          name: data.owner.login,\n          avatarURL: data.owner.avatar_url,\n      }\n      : undefined;\n}\n\nfunction createGistData(data, secret, gist_id) {\n  let files = data.files.reduce((files, file) => {\n    files[file.name] = {\n      content: file.content.trim() ? file.content : `${emptyValue}${file.content}`,\n    };\n    return files;\n  }, {});\n  const saveData = {\n    ...data,\n  };\n  const jsGistData = {}\n  files['jsGist.json'] = jsGistData;\n  const noDuplicateNames = Object.keys(files).length === data.files.length + 1;\n  if (noDuplicateNames) {\n    delete saveData.files;\n    saveData.filenames = data.files.map(({name}) => name);\n  } else {\n    // save the files in the json\n    files = {\n      'jsGist.json': jsGistData,\n    };\n  }\n  jsGistData.content = JSON.stringify(saveData);\n  if (gist_id) {\n    // TODO: rather than check if there's a readme\n    // insert the readme in our wrapped readme.\n    // Maybe add a \"notes\" field to the save dialog\n    const lowerCaseFiles = Object.keys(files).map(n => n.toLowerCase());\n    const hadReadme = \n        lowerCaseFiles.includes('readme.md') ||\n        lowerCaseFiles.includes('readme.txt') ||\n        lowerCaseFiles.includes('readme');\n    if (!hadReadme) {\n      const content = `## ${data.name}\\n\\n[view on jsgist](${window.location.origin}?src=${gist_id})`\n      files['README.md'] = {content};\n    }\n    // if we have a gist_id this is an update\n    // updates need filenames (which allows renaming)\n    for (const [filename, file] of Object.entries(files)) {\n      file.filename = filename;\n    }\n  }\n  return {\n    files,\n    description: data.name,\n    ...(!gist_id && {public: !secret}),\n    ...(gist_id && {gist_id}),\n  };\n}\n\nexport default class GitHub extends EventTarget {\n  constructor() {\n    super();\n    this.pat = '';\n    this.user = {};\n    this.unAuthorizedOctokit = new Octokit({\n      userAgent,\n    });\n  }\n  get octokit() {\n    return this.authorizedOctokit || this.unAuthorizedOctokit;\n  }\n  // TODO: this does not belong here!\n  _updateUserData(data) {\n    const userData = getUserData(data);\n    if (userData) {\n      Object.assign(this.user, userData);\n      const event = new Event('userdata');\n      event.data = {...this.user};\n      this.dispatchEvent(event);\n    }\n  }\n  setPat(pat) {\n    if (pat !== this.pat) {\n      this.pat = pat;\n      if (pat) {\n        this.authorizedOctokit = new Octokit({\n          auth: pat,\n          userAgent,\n        });\n      } else {\n        this.authorizedOctokit = undefined;\n      }\n    }\n  }\n  /*\n  \"{\n    \"login\": \"greggman\",\n    \"id\": 234804,\n    \"node_id\": \"MDQ6VXNlcjIzNDgwNA==\",\n    \"avatar_url\": \"https://avatars2.githubusercontent.com/u/234804?v=4\",\n    \"gravatar_id\": \"\",\n    \"url\": \"https://api.github.com/users/greggman\",\n    \"html_url\": \"https://github.com/greggman\",\n    \"followers_url\": \"https://api.github.com/users/greggman/followers\",\n    \"following_url\": \"https://api.github.com/users/greggman/following{/other_user}\",\n    \"gists_url\": \"https://api.github.com/users/greggman/gists{/gist_id}\",\n    \"starred_url\": \"https://api.github.com/users/greggman/starred{/owner}{/repo}\",\n    \"subscriptions_url\": \"https://api.github.com/users/greggman/subscriptions\",\n    \"organizations_url\": \"https://api.github.com/users/greggman/orgs\",\n    \"repos_url\": \"https://api.github.com/users/greggman/repos\",\n    \"events_url\": \"https://api.github.com/users/greggman/events{/privacy}\",\n    \"received_events_url\": \"https://api.github.com/users/greggman/received_events\",\n    \"type\": \"User\",\n    \"site_admin\": false,\n    \"name\": \"Greggman\",\n    \"company\": null,\n    \"blog\": \"http://games.greggman.com\",\n    \"location\": \"Earth\",\n    \"email\": \"github@greggman.com\",\n    \"hireable\": null,\n    \"bio\": \"30 years of games\\r\\n5 years of Chrome\",\n    \"twitter_username\": null,\n    \"public_repos\": 283,\n    \"public_gists\": 79,\n    \"followers\": 1037,\n    \"following\": 3,\n    \"created_at\": \"2010-04-01T08:48:05Z\",\n    \"updated_at\": \"2020-10-24T06:05:24Z\"\n  }\"\n  */\n  async getAuthenticatedUser() {\n    const response = await this.authorizedOctokit.users.getAuthenticated();\n    if (response.status !== 200) {\n      throw new Error(response.message);\n    }\n    return response.data;\n  }\n\n  async getUserGists() {\n    const gists = await this.authorizedOctokit.paginate(\n        this.authorizedOctokit.gists.list,\n        {per_page: 100});\n    return gists.filter(gist => !!gist.files['jsGist.json']);\n    // return await this.authorizedOctokit.gists.list();\n  }\n\n  async getGist(gist_id) {\n    const octokit = this.authorizedOctokit || this.octokit;\n    const gist = await octokit.gists.get({gist_id});\n    return {\n      data: getGistContent(gist.data),\n      rawData: gist.data,\n    };\n  }\n\n  async createGist(data, secret = false) {\n    // TODO: Since we're doing the double save (create gist to get an id\n    // so we can make the README.me) we should probably not send any data\n    // the first time.\n    const gistData = createGistData(data, secret);\n    const gist = await this.authorizedOctokit.gists.create(gistData);\n    this._updateUserData(gist.data);\n    return await this.updateGist(gist.data.id, data);\n  }\n  async updateGist(gist_id, data) {\n    const gistData = createGistData(data, false, gist_id);\n    const gist = await this.authorizedOctokit.gists.update(gistData);\n    return {\n      id: gist.data.id,\n      name: gist.data.description,\n      date: gist.data.updated_at,\n      public: gist.data.public,\n    };\n  }\n  async forkGist(gist_id) {\n    const gist = await this.authorizedOctokit.gists.fork({gist_id});\n    return {\n      id: gist.data.id\n    };\n  }\n  async deleteGist(gist_id) {\n    const result = await this.authorizedOctokit.gists.delete({gist_id});\n    return result;\n  }\n  async createGistComment(gist_id, body) {\n    const result = await this.authorizedOctokit.gists.createComment({\n      gist_id,\n      body,\n    });\n    if (result.status < 200 || result.status >= 300) {\n      throw new Error(result.message);\n    }\n    return result.data;\n  }\n}\n\n","import React from 'react';\n\nexport default class Dialog extends React.Component {\n  componentDidMount() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  }\n  handleKeyDown = (e) => {\n    if (e.keyCode === 27) {\n      this.props.onClose();\n    }\n  }\n  render() {\n    const {title, children, onClose, className = ''} = this.props;\n    return (\n      <div onClick={onClose} className={`${className} dialog`}>\n        <div\n          tabIndex=\"-1\"\n          onClick={(e) =>{e.stopPropagation()}}\n        >\n          <div className=\"dialog-heading\">\n            <div className=\"dialog-title\">{title}</div>\n            <div className=\"dialog-close\">\n              <button onClick={onClose}>X</button>\n            </div>\n          </div>\n          <div className=\"dialog-content\">\n            {children}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import Ajv from 'ajv';\n\nimport {isDevelopment} from './flags.js';\nimport schema from './schema.json';\n\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst validator = ajv.compile(schema);\n\nconst trackedValues = {};\n\nfunction getValueOrMakeNew(name) {\n  const trackedValue = trackedValues[name] || {\n    subscriptions: new Set(),\n  };\n  trackedValues[name] = trackedValue;\n  return trackedValue;\n}\n\nexport function add(name, initialValue) {\n  const trackedValue = getValueOrMakeNew(name);\n  if (initialValue !== undefined) {\n    trackedValue.value = initialValue;\n  }\n  return trackedValue;\n}\n\nexport function get(name) {\n  return trackedValues[name].value;\n}\n\nexport function set(name, newValue) {\n  const trackedValue = trackedValues[name];\n  if (!trackedValue) {\n    throw new Error(`no such track value: ${name}`);\n  }\n  trackedValue.value = newValue;\n  const fns = [...trackedValue.subscriptions.keys()];\n  for (const fn of fns) {\n    fn(newValue, name);\n  }\n}\n\nexport function subscribe(name, fn) {\n  const trackedValue = getValueOrMakeNew(name);\n  trackedValue.subscriptions.add(fn);\n}\n\nexport function unsubscribe(name, fn) {\n  const trackedValue = getValueOrMakeNew(name);\n  trackedValue.subscriptions.delete(fn);\n}\n\nconst newTestData = {\n  \"name\": \"My jsGist\",\n  \"settings\": {},\n  \"files\": [\n    {\n      name: \"index.html\",\n      content: \"\",\n    },\n    {\n      name: \"index.css\",\n      content: \"\",\n    },\n    {\n      name: \"index.js\",\n      content: \"\",\n    },\n  ],\n};\nexport function getNewData() {\n  return JSON.parse(JSON.stringify(newTestData));\n}\nexport function getBlankData() {\n  const url = `${window.location.origin}/resources/images/logo.svg`;\n  return JSON.parse(JSON.stringify({\n    \"name\": \"jsGist\",\n    \"settings\": {},\n    \"files\": [\n      {\n        \"name\": \"index.html\",\n        \"content\": ``,\n      },\n      {\n        \"name\": \"index.css\",\n        \"content\": `\n          html, body {\n            margin: 0;\n            width: 100%;\n            height: 100%;\n            background-image: url(${url});\n            background-size: contain contain;\n            background-position: center center;\n            background-repeat: no-repeat no-repeat;\n          }\n          @media (prefers-color-scheme: dark) {\n            html {\n              background: #222;\n            }\n          }\n        `,\n      },\n      {\n        \"name\": \"index.js\",\n        \"content\": \"\",\n      }\n    ]\n  }));\n}\n\nlet data;\nexport function getData() {\n  return data;\n}\n\nexport const dataVersionKey = 'dataVersion';\nexport const updateVersionKey = 'updateVersion';\nexport const filesVersionKey = 'filesVersion';\n\nadd(dataVersionKey, 0);   // any data changes (when an item in the data is change)\nadd(updateVersionKey, 0);  // all data changes (when the entire data objects replaced with new data)\nadd(filesVersionKey, 0);  // files added or removed or the main name is changed\n\nconst incVersion = key => set(key, get(key) + 1);\nconst incDataVersion = _ => incVersion(dataVersionKey);\nconst incFilesVersion = _ => incVersion(filesVersionKey);\nconst incUpdateVersion = _ => {\n  incVersion(updateVersionKey);\n  incDataVersion();\n  incFilesVersion();\n};\n\nfunction getUniqueName(basename) {\n  const filenames = new Set(data.files.map(f => f.name));\n  for (let count = data.files.length + 1; ; ++count) {\n    const name = `${basename}${count}`;\n    if (!filenames.has(name)) {\n      return name;\n    }\n  }\n}\n\nexport function addFile(name = \"\", content = \"\") {\n  name = name || getUniqueName('unnamed');\n  data.files.push({\n    name,\n    content,\n  });\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function setName(name) {\n  data.name = name;\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function setFileName(ndx, newName) {\n  data.files[ndx].name = newName;\n  incDataVersion();\n}\n\nexport function setFileContent(ndx, content) {\n  data.files[ndx].content = content;\n  incDataVersion();\n}\n\nexport function setFileType(ndx, type) {\n  data.files[ndx].type = type;\n  incDataVersion();\n}\n\nexport function deleteFile(ndx) {\n  data.files.splice(ndx, 1);\n  incDataVersion();\n  incFilesVersion();\n}\n\nexport function validate(data) {\n  if (!validator(data)) {\n    throw new Error(`data not valid:\\n${validator.errors.map(e => `${e.message}: ${e.dataPath}`)}`);\n  }\n}\n\nexport function setData(newData) {\n  validate(newData);\n  data = newData;\n  if (isDevelopment) {\n    window.d = data;\n  }\n  incUpdateVersion();\n}\n\nsetData(isDevelopment ? {\n  \"name\": \"ThreeJSFundamentals Scenegraph Tank\",\n  \"settings\": {},\n  \"files\": [\n    {\n      \"name\": \"index.html\",\n      \"content\": \"<canvas id=\\\"c\\\"></canvas>\\n<div id=\\\"info\\\"></div>\",\n    },\n    {\n      \"name\": \"index.css\",\n      \"content\": \"body {\\n  margin: 0;\\n}\\n#c {\\n  width: 100vw;\\n  height: 100vh;\\n  display: block;\\n}\\n#info { \\n  position: absolute; \\n  left: 1em; \\n  top: 1em; \\n  background: rgba(0,0,0,.8); \\n  padding: .5em;\\n  color: white;\\n  font-family: monospace;\\n}\",\n    },\n    {\n      \"name\": \"index.js\",\n      \"content\": \"import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r119/build/three.module.js';\\n\\nfunction main() {\\n  const canvas = document.querySelector('#c');\\n  const renderer = new THREE.WebGLRenderer({canvas: canvas});\\n  renderer.setClearColor(0xAAAAAA);\\n  renderer.shadowMap.enabled = true;\\n\\n  function makeCamera(fov = 40) {\\n    const aspect = 2;  // the canvas default\\n    const zNear = 0.1;\\n    const zFar = 1000;\\n    return new THREE.PerspectiveCamera(fov, aspect, zNear, zFar);\\n  }\\n  const camera = makeCamera();\\n  camera.position.set(8, 4, 10).multiplyScalar(3);\\n  camera.lookAt(0, 0, 0);\\n\\n  const scene = new THREE.Scene();\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(0, 20, 0);\\n    scene.add(light);\\n    light.castShadow = true;\\n    light.shadow.mapSize.width = 2048;\\n    light.shadow.mapSize.height = 2048;\\n\\n    const d = 50;\\n    light.shadow.camera.left = -d;\\n    light.shadow.camera.right = d;\\n    light.shadow.camera.top = d;\\n    light.shadow.camera.bottom = -d;\\n    light.shadow.camera.near = 1;\\n    light.shadow.camera.far = 50;\\n    light.shadow.bias = 0.001;\\n  }\\n\\n  {\\n    const light = new THREE.DirectionalLight(0xffffff, 1);\\n    light.position.set(1, 2, 4);\\n    scene.add(light);\\n  }\\n\\n  const groundGeometry = new THREE.PlaneBufferGeometry(50, 50);\\n  const groundMaterial = new THREE.MeshPhongMaterial({color: 0xCC8866});\\n  const groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);\\n  groundMesh.rotation.x = Math.PI * -.5;\\n  groundMesh.receiveShadow = true;\\n  scene.add(groundMesh);\\n\\n  const carWidth = 4;\\n  const carHeight = 1;\\n  const carLength = 8;\\n\\n  const tank = new THREE.Object3D();\\n  scene.add(tank);\\n\\n  const bodyGeometry = new THREE.BoxBufferGeometry(carWidth, carHeight, carLength);\\n  const bodyMaterial = new THREE.MeshPhongMaterial({color: 0x6688AA});\\n  const bodyMesh = new THREE.Mesh(bodyGeometry, bodyMaterial);\\n  bodyMesh.position.y = 1.4;\\n  bodyMesh.castShadow = true;\\n  tank.add(bodyMesh);\\n\\n  const tankCameraFov = 75;\\n  const tankCamera = makeCamera(tankCameraFov);\\n  tankCamera.position.y = 3;\\n  tankCamera.position.z = -6;\\n  tankCamera.rotation.y = Math.PI;\\n  bodyMesh.add(tankCamera);\\n\\n  const wheelRadius = 1;\\n  const wheelThickness = .5;\\n  const wheelSegments = 6;\\n  const wheelGeometry = new THREE.CylinderBufferGeometry(\\n      wheelRadius,     // top radius\\n      wheelRadius,     // bottom radius\\n      wheelThickness,  // height of cylinder\\n      wheelSegments);\\n  const wheelMaterial = new THREE.MeshPhongMaterial({color: 0x888888});\\n  const wheelPositions = [\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2,  carLength / 3],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, 0],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, 0],\\n    [-carWidth / 2 - wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n    [ carWidth / 2 + wheelThickness / 2, -carHeight / 2, -carLength / 3],\\n  ];\\n  const wheelMeshes = wheelPositions.map((position) => {\\n    const mesh = new THREE.Mesh(wheelGeometry, wheelMaterial);\\n    mesh.position.set(...position);\\n    mesh.rotation.z = Math.PI * .5;\\n    mesh.castShadow = true;\\n    bodyMesh.add(mesh);\\n    return mesh;\\n  });\\n\\n  const domeRadius = 2;\\n  const domeWidthSubdivisions = 12;\\n  const domeHeightSubdivisions = 12;\\n  const domePhiStart = 0;\\n  const domePhiEnd = Math.PI * 2;\\n  const domeThetaStart = 0;\\n  const domeThetaEnd = Math.PI * .5;\\n  const domeGeometry = new THREE.SphereBufferGeometry(\\n    domeRadius, domeWidthSubdivisions, domeHeightSubdivisions,\\n    domePhiStart, domePhiEnd, domeThetaStart, domeThetaEnd);\\n  const domeMesh = new THREE.Mesh(domeGeometry, bodyMaterial);\\n  domeMesh.castShadow = true;\\n  bodyMesh.add(domeMesh);\\n  domeMesh.position.y = .5;\\n\\n  const turretWidth = .1;\\n  const turretHeight = .1;\\n  const turretLength = carLength * .75 * .2;\\n  const turretGeometry = new THREE.BoxBufferGeometry(\\n      turretWidth, turretHeight, turretLength);\\n  const turretMesh = new THREE.Mesh(turretGeometry, bodyMaterial);\\n  const turretPivot = new THREE.Object3D();\\n  turretMesh.castShadow = true;\\n  turretPivot.scale.set(5, 5, 5);\\n  turretPivot.position.y = .5;\\n  turretMesh.position.z = turretLength * .5;\\n  turretPivot.add(turretMesh);\\n  bodyMesh.add(turretPivot);\\n\\n  const turretCamera = makeCamera();\\n  turretCamera.position.y = .75 * .2;\\n  turretMesh.add(turretCamera);\\n\\n  const targetGeometry = new THREE.SphereBufferGeometry(.5, 6, 3);\\n  const targetMaterial = new THREE.MeshPhongMaterial({color: 0x00FF00, flatShading: true});\\n  const targetMesh = new THREE.Mesh(targetGeometry, targetMaterial);\\n  const targetOrbit = new THREE.Object3D();\\n  const targetElevation = new THREE.Object3D();\\n  const targetBob = new THREE.Object3D();\\n  targetMesh.castShadow = true;\\n  scene.add(targetOrbit);\\n  targetOrbit.add(targetElevation);\\n  targetElevation.position.z = carLength * 2;\\n  targetElevation.position.y = 8;\\n  targetElevation.add(targetBob);\\n  targetBob.add(targetMesh);\\n\\n  const targetCamera = makeCamera();\\n  const targetCameraPivot = new THREE.Object3D();\\n  targetCamera.position.y = 1;\\n  targetCamera.position.z = -2;\\n  targetCamera.rotation.y = Math.PI;\\n  targetBob.add(targetCameraPivot);\\n  targetCameraPivot.add(targetCamera);\\n\\n  // Create a sine-like wave\\n  const curve = new THREE.SplineCurve( [\\n    new THREE.Vector2( -10, 0 ),\\n    new THREE.Vector2( -5, 5 ),\\n    new THREE.Vector2( 0, 0 ),\\n    new THREE.Vector2( 5, -5 ),\\n    new THREE.Vector2( 10, 0 ),\\n    new THREE.Vector2( 5, 10 ),\\n    new THREE.Vector2( -5, 10 ),\\n    new THREE.Vector2( -10, -10 ),\\n    new THREE.Vector2( -15, -8 ),\\n    new THREE.Vector2( -10, 0 ),\\n  ] );\\n\\n  const points = curve.getPoints( 50 );\\n  const geometry = new THREE.BufferGeometry().setFromPoints( points );\\n  const material = new THREE.LineBasicMaterial( { color : 0xff0000 } );\\n  const splineObject = new THREE.Line( geometry, material );\\n  splineObject.rotation.x = Math.PI * .5;\\n  splineObject.position.y = 0.05;\\n  scene.add(splineObject);\\n\\n  function resizeRendererToDisplaySize(renderer) {\\n    const canvas = renderer.domElement;\\n    const width = canvas.clientWidth;\\n    const height = canvas.clientHeight;\\n    const needResize = canvas.width !== width || canvas.height !== height;\\n    if (needResize) {\\n      renderer.setSize(width, height, false);\\n    }\\n    return needResize;\\n  }\\n\\n  const targetPosition = new THREE.Vector3();\\n  const tankPosition = new THREE.Vector2();\\n  const tankTarget = new THREE.Vector2();\\n\\n  const cameras = [\\n    { cam: camera, desc: 'detached camera', },\\n    { cam: turretCamera, desc: 'on turret looking at target', },\\n    { cam: targetCamera, desc: 'near target looking at tank', },\\n    { cam: tankCamera, desc: 'above back of tank', },\\n  ];\\n\\n  const infoElem = document.querySelector('#info');\\n\\n  function render(time) {\\n    time *= 0.001;\\n\\n    if (resizeRendererToDisplaySize(renderer)) {\\n      const canvas = renderer.domElement;\\n      cameras.forEach((cameraInfo) => {\\n        const camera = cameraInfo.cam;\\n        camera.aspect = canvas.clientWidth / canvas.clientHeight;\\n        camera.updateProjectionMatrix();\\n      });\\n    }\\n\\n    // move target\\n    targetOrbit.rotation.y = time * .27;\\n    targetBob.position.y = Math.sin(time * 2) * 4;\\n    targetMesh.rotation.x = time * 7;\\n    targetMesh.rotation.y = time * 13;\\n    targetMaterial.emissive.setHSL(time * 10 % 1, 1, .25);\\n    targetMaterial.color.setHSL(time * 10 % 1, 1, .25);\\n\\n    // move tank\\n    const tankTime = time * .05;\\n    curve.getPointAt(tankTime % 1, tankPosition);\\n    curve.getPointAt((tankTime + 0.01) % 1, tankTarget);\\n    tank.position.set(tankPosition.x, 0, tankPosition.y);\\n    tank.lookAt(tankTarget.x, 0, tankTarget.y);\\n\\n    // face turret at target\\n    targetMesh.getWorldPosition(targetPosition);\\n    turretPivot.lookAt(targetPosition);\\n\\n    // make the turretCamera look at target\\n    turretCamera.lookAt(targetPosition);\\n\\n    // make the targetCameraPivot look at the at the tank\\n    tank.getWorldPosition(targetPosition);\\n    targetCameraPivot.lookAt(targetPosition);\\n\\n    wheelMeshes.forEach((obj) => {\\n      obj.rotation.x = time * 3;\\n    });\\n\\n    const camera = cameras[time * .25 % cameras.length | 0];\\n    infoElem.textContent = camera.desc;\\n\\n    renderer.render(scene, camera.cam);\\n\\n    requestAnimationFrame(render);\\n  }\\n\\n  requestAnimationFrame(render);\\n}\\n\\nmain();\\n\",\n    }\n  ]\n} : getNewData());\n","const camelCaseRE = /([a-z])([A-Z])/g;\nconst toDash = (_, left, right) => `${left}-${right}`;\nconst camelCaseToDash = s => s.replace(camelCaseRE, toDash).toLowerCase();\n\nexport function classNames(...args) {\n  const names = [];\n  for (const arg of args) {\n    if (typeof arg === 'string') {\n      names.push(arg);\n    } else {\n      for (const [key, value] of Object.entries(arg)) {\n        if (value) {\n          names.push(camelCaseToDash(key));\n        }\n      }\n    }\n  }\n  return names.join(' ');\n}","import React from 'react';\n//import {Resizable} from 're-resizable';\nimport Code from './Code.js';\nimport {classNames} from '../libs/css-utils.js';\n\nexport default function CodeArea(props) {\n  const {\n    value,\n    hackKey,\n    heading,\n    extra = [],\n    options = {},\n    onValueChange,\n    registerAPI,\n  } = props;\n  return (\n    <div className=\"code-area\" style={props.style}>\n        <div className=\"expander\">\n          {heading}\n        </div>\n        <div className={classNames(\"hidee\")}>\n            <Code\n              hackKey={hackKey}\n              value={value}\n              options={options}\n              onValueChange={onValueChange}\n              registerAPI={registerAPI}\n            />\n          {extra}\n        </div>\n    </div>\n  );\n};\n","import {storageManager} from '../globals.js';\nimport * as model from './model.js';\n\nconst settingsKey = 'ui-settings';\n\nlet initialized = false;\nlet settings;\n\nfunction init() {\n  if (initialized) {\n    return;\n  }\n  initialized = true;\n  try {\n    settings = JSON.parse(storageManager.get(settingsKey, true));\n    if (!settings) {\n      throw new Error('no settings');\n    }\n  } catch (e) {\n    settings = {\n      layout: (window.screen.width < 540 || window.screen.height < 540) ? 3 : 0,\n    };\n  }\n}\n\nmodel.add('settings', settings);\n\nexport function set(name, value) {\n  settings[name] = value;\n  const json = JSON.stringify(settings);\n  storageManager.set(settingsKey, json, true);\n  model.set('settings', settings);\n}\n\nexport function get() {\n  init();\n  return settings;\n}\n\nexport function subscribe(fn) {\n  model.subscribe('settings', fn);\n}\n\nexport function unsubscribe(fn) {\n  model.unsubscribe('settings', fn);\n}\n","import mime from 'mime-types';\nimport React from 'react';\n// import EditLine from './EditLine.js';\nimport CodeArea from './CodeArea.js';\n\nexport default class File extends React.Component {\n  componentDidMount() {\n    const {register} = this.props;\n    register(this, {\n      goToLine: (data) => {\n        const {title} = this.props;\n        if (data.section === title) {\n          this.codeAPI.goToLine(data.lineNo, data.colNo);\n          return true;\n        }\n      },\n      refresh: _ => this.codeAPI.refresh(),\n      focus: _ => this.codeAPI.focus(),\n    });\n  }\n  componentWillUnmount() {\n    const {unregister} = this.props;\n    unregister(this);\n  }\n  handleRegisterAPI = (api) => {\n    this.codeAPI = api;\n  }\n  render() {\n    const props = this.props;\n    const {title, hackKey} = props;\n    const heading = (\n      <div style={{width: '100%'}}>{title}</div>\n    );\n    const mimeType = mime.lookup(title) || (title.toLowerCase() === 'javascript' ? 'application/javascript' : 'application/octet-stream');\n    const options = {\n      ...props.options,\n      editor: {\n        ...(props.options?.editor && props.options.editor),\n        mode: mimeType,\n      },\n    };\n    return (\n      <CodeArea\n        key={hackKey}\n        {...props}\n        options={options}\n        heading={heading}\n        registerAPI={this.handleRegisterAPI}\n      />\n    );\n  }\n}\n\n/*\nexport default function TestArea(props) {\n  const {desc, title, onTitleChange, hackKey} = props;\n  const heading = (\n    <div>{title}</div>\n    <EditLine\n      placeholder={desc}\n      value={title}\n      onChange={onTitleChange}\n    />\n  );\n\n  return (\n    <CodeArea key={hackKey} {...props} heading={heading} />\n  );\n}\n*/\n","import Ajv from 'ajv';\nimport React from 'react';\nimport Split, {moveGuttersComputeNewSizes} from 'react-split-it';\n\nimport * as model from '../libs/model.js';\nimport File from './File.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst makeId = _ => `${Date.now()}+${Math.random()}`;\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}},\n  },\n  \"required\": [\"sizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Files extends React.Component {\n  constructor(props) {\n    super(props);\n    this.files = new Map();\n    this.fileToKeyMap = new Map();\n    this.kUIStateKey = `${props.uiStateKey}-files`;\n    const state = uiModel.get()[this.kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      sizes: [],\n    };\n    if (this.state.sizes.length !== props.data.files.length) {\n      this.state.sizes = props.data.files.map((_, i) => 1 / props.data.files.length);\n    }\n  }\n  onSetSizes = (sizes) => {\n    this.setState({sizes});\n    uiModel.set(this.kUIStateKey, this.state);\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  getFileKey(test) {\n    let key = this.fileToKeyMap.get(test);\n    if (!key) {\n      key = makeId();\n      this.fileToKeyMap.set(test, key);\n    }\n    return key;\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n    registerAPI({\n      goToLine: (data) => {\n        this.files.forEach(api => {\n          api.goToLine(data);\n        });\n      },\n    });\n  }\n  render() {\n    const {hackKey, data, extra, direction} = this.props;\n    const {sizes} = this.state;\n    return (\n      <div className=\"codes\">\n        <Split\n          direction={direction}\n          minSize={0}\n          sizes={sizes}\n          onSetSizes={this.onSetSizes}\n          computeNewSizesFn={moveGuttersComputeNewSizes}\n        >\n        {\n          data.files.map((file, ndx) => {\n            return (\n              <File\n                key={`ca${this.getFileKey(file)}`}\n                hackKey={hackKey}\n                desc=\"filename\"\n                title={file.name}\n                value={file.content}\n                onTitleChange={name => model.setFileName(ndx, name)}\n                onValueChange={value => model.setFileContent(ndx, value)}\n                register={this.handleRegister}\n                unregister={this.handleUnregister}\n                extra={extra}\n              />\n            );\n          })\n        }\n        </Split>\n      </div>\n    );\n  }\n}\n\n//         {/*<button onClick={() => model.addFile()}>+</button>*/}\n","import React from 'react';\n\nimport {classNames} from '../libs/css-utils';\nimport ServiceContext from '../ServiceContext.js';\n\nfunction basename(url) {\n  const ndx = url.lastIndexOf('/');\n  return ndx >= 0 ? url.substr(ndx + 1) : url;\n}\n\nfunction isMsgSame(oldMsg, newMsg) {\n  if (!!oldMsg !== !!newMsg) {\n    return false;\n  }\n  const keys = Object.keys(oldMsg).filter(key => key !== 'count');\n  if (keys.length !== Object.keys(newMsg).length) {\n    return false;\n  }\n  for (const key of keys) {\n    if (oldMsg[key] !== newMsg[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport class LogManager extends EventTarget {\n  constructor() {\n    super();\n    this._msgs = [];\n  }\n  _notify() {\n    this.dispatchEvent(new Event('change'));\n  }\n  clear = () => {\n    this._msgs = [];\n    this._notify();\n  }\n  _addMsg = (data) => {\n    const lastData = this._msgs[this._msgs.length - 1];\n    if (isMsgSame(lastData, data)) {\n      lastData.count = (lastData.count || 0) + 1;\n    } else {\n      this._msgs.push(data);\n    }\n  }\n  addMsg = (data) => {\n    this._addMsg(data);\n    this._notify();\n  }\n  addMsgs = (msgs) => {\n    for (const {type, data} of msgs) {\n      switch (type) {\n        case 'jsError':\n          this._addMsg({...data, type: 'error', showStack: true});\n          break;\n        case 'jsUnhandledRejection':\n          this._addMsg({...data, type: 'error', showStack: true});\n          break;\n        default:\n          this._addMsg(data);\n          break;\n      }\n    }\n    this._notify();\n  }\n  getMsgs() {\n    return this._msgs\n  }\n}\n\nexport default class Log extends React.Component {\n  constructor(props) {\n    super(props);\n    this.logMessagesRef = React.createRef();\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  componentDidMount() {\n    const {logManager} = this.context;\n    logManager.addEventListener('change', this.handleChange);\n  }\n  componentWillUnmount() {\n    const {logManager} = this.context;\n    logManager.removeEventListener('change', this.handleChange);\n  }\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (snapshot !== null) {\n      // if we were at the bottom of the log then\n      // stay at the bottom of the log\n      if (snapshot < 1) {\n        const elem = this.logMessagesRef.current;\n        elem.scrollTop = elem.scrollHeight - elem.parentElement.clientHeight;\n      }\n    }\n  }\n  getSnapshotBeforeUpdate(prevProps, prevState) {\n    const elem = this.logMessagesRef.current;\n    return elem.scrollHeight - (elem.scrollTop + elem.parentElement.clientHeight);\n  }\n  render() {\n    const {onGoToLine} = this.props;\n    const {logManager} = this.context;\n    return (\n      <div className=\"logger\">\n        <div className=\"log-messages layout-scrollbar\" ref={this.logMessagesRef}>\n          { logManager.getMsgs().map((msg, ndx) => {\n              const tooltip = !msg.section;\n              return (\n                <div className={classNames('log-line',{[msg.type]: true})} key={`l${ndx}`}>\n                  <div className={msg.count ? \"count\" : \"no-count\"}>{msg.count ? msg.count : ''}</div>\n                  <div className=\"msg\">\n                    {msg.msg}\n                    <span>&nbsp;</span> {/* this is to prevent auto-selection to the next element when double clicking */}\n                    <div\n                      className={classNames('file', {tooltip, fileLink: msg.section})}\n                      onClick={() => onGoToLine(msg)}\n                      data-tooltip={`${msg.section || msg.url}:${msg.lineNo}`}\n                    >\n                      {msg.section || basename(msg.url || '')}:{msg.lineNo}\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n        </div>\n      </div>\n    );\n  }\n}\n\nLog.contextType = ServiceContext;","import React from 'react';\n\nimport {isDevelopment} from '../libs/flags.js';\nimport ServiceContext from '../ServiceContext.js';\nimport {createURL} from '../libs/url.js';\nimport * as winMsgMgr from '../libs/WindowMessageManager';\n\nexport default class Runner extends React.Component {\n  constructor(props) {\n    super(props);\n    this.runnerRef = React.createRef();\n  }\n  handleJSLog = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg(data);\n  }\n  handleJSError = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg({...data, type: 'error', showStack: true});\n  }\n  handleJSUnhandledRejection = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsg({...data, type: 'error', showStack: true});\n  }\n  handleInfoMessages = (data) => {\n    const {logManager} = this.context;\n    logManager.addMsgs(data);\n  }\n  handleGimmeDaCodez = () => {\n    this.iframe.contentWindow.postMessage({\n      type: 'run',\n      data: this.data,\n    }, \"*\");\n  }\n  componentDidMount() {\n    const {registerAPI} = this.props;\n    registerAPI({\n      run: (data, blank) => {\n        this.data = data;\n        this.removeIFrame();\n        const iframe = document.createElement('iframe');\n        this.iframe = iframe;\n        iframe.src = isDevelopment\n            ? createURL(`http://${window.location.hostname}:8081/runner-03.html`, {url: `http://${window.location.hostname}:8080/jsgist-runner.js`})\n            : createURL('https://jsgistrunner.devcomments.org/runner-03.html', {url: 'https://jsgist.org/jsgist-runner.js'});\n        if (blank) {\n          iframe.style.background = 'none';\n        }\n        this.runnerRef.current.appendChild(iframe);\n      },\n    })\n    winMsgMgr.on('gimmeDaCodez', null, this.handleGimmeDaCodez);\n    winMsgMgr.on('jsLog', null, this.handleJSLog);\n    winMsgMgr.on('jsError', null, this.handleJSError);\n    winMsgMgr.on('jsUnhandledRejection', null, this.handleJSUnhandledRejection);\n    winMsgMgr.on('infoMessages', null, this.handleInfoMessages);\n  }\n  removeIFrame() {\n    if (this.iframe) {\n      this.iframe.remove();\n      this.iframe.src = 'about:blank';\n      this.iframe = undefined;\n    }\n  }\n  componentWillUnmount() {\n    this.removeIFrame();\n    winMsgMgr.remove('gimmeDaCodez', null, this.handleGimmeDaCodez);\n    winMsgMgr.remove('jsLog', null, this.handleJSLog);\n    winMsgMgr.remove('jsError', null, this.handleJSError);\n    winMsgMgr.remove('jsUnhandledRejection', null, this.handleJSUnhandledRejection);\n    winMsgMgr.remove('infoMessages', null, this.handleInfoMessages);\n  }\n  handleMessage = (e) => {\n    const {type, data} =  e.data;\n    const fn = this.handlers[type];\n    if (fn) {\n      fn(data);\n    }\n  }\n  render() {\n    return (\n      <div className=\"runner\" ref={this.runnerRef}></div>\n    )\n  }\n}\n\nRunner.contextType = ServiceContext;","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport Files from './Files.js';\nimport Log from './Log.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layout3Vertical';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"hSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"vSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"hSizes\", \"vSizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Layout3Vertical extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      hSizes: [0.5, 0.5],\n      vSizes: [0.9, 0.1],\n    };\n  }\n  onSetVSizes = (sizes) => {\n    this.setState({vSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetHSizes = (sizes) => {\n    this.setState({hSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  registerFilesAPI = (api) => {\n    this.filesAPI = api;\n  }\n  handleGoToLine = (data) => {\n    this.filesAPI.goToLine(data);\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {vSizes, hSizes} = this.state;\n    return (\n      <Split direction=\"horizontal\" minSize={0} sizes={hSizes} onSetSizes={this.onSetHSizes}>\n        <div className=\"left\">\n          <Files\n            direction=\"vertical\"\n            uiStateKey={kUIStateKey}\n            data={data}\n            hackKey={hackKey}\n            registerAPI={this.registerFilesAPI}\n          />\n        </div>\n        <div className=\"right\">\n          <Split direction=\"vertical\" minSize={0} sizes={vSizes} onSetSizes={this.onSetVSizes}>\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport Files from './Files.js';\nimport Log from './Log.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layout3Horizontal';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"tSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"bSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"tSizes\", \"bSizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nexport default class Layout3Horizontal extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      tSizes: [0.5, 0.5],\n      bSizes: [0.9, 0.1],\n    };\n  }\n  onSetTSizes = (sizes) => {\n    this.setState({tSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetBSizes = (sizes) => {\n    this.setState({bSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  registerFilesAPI = (api) => {\n    this.filesAPI = api;\n  }\n  handleGoToLine = (data) => {\n    this.filesAPI.goToLine(data);\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {tSizes, bSizes} = this.state;\n    return (\n      <Split direction=\"vertical\" minSize={0} sizes={tSizes} onSetSizes={this.onSetTSizes}>\n        <div className=\"layout-3-horizontal-top\">\n          <Files uiStateKey={kUIStateKey} direction=\"horizontal\" data={data} hackKey={hackKey} registerAPI={this.registerFilesAPI} />\n        </div>\n        <div className=\"layout-3-horizontal-bottom\">\n          <Split direction=\"vertical\"  sizes={bSizes} onSetSizes={this.onSetBSizes}>\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","export const noop = () => {};\nexport const wait = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport function escapeTextForHTMLContent(s: string) {\n  return s.replace(/&/g, '&amp;')\n          .replace(/</g, '&lt;')\n          .replace(/>/g, '&gt;');\n}\n\nfunction findNdx(files: any, endings: string[]) {\n  // calling toLowerCase a bunch is bad but there will never be more than a few files\n  for (const ending of endings) {\n    const ndx = files.findIndex((file: any) => file.name.toLowerCase().endsWith(ending.toLowerCase()));\n    if (ndx >= 0) {\n      return ndx;\n    }\n  }\n  return -1;\n}\n\nexport function getOrFindNdx(files: any[], name: string, ...endings: string[]) {\n  const ndx = files.findIndex(f => f.name.toLowerCase() === name.toLowerCase);\n  if (ndx >= 0) {\n    return ndx;\n  }\n  return findNdx(files, endings);\n}\n\nexport function getOrFind(files: any[], ...args: string[]) {\n  const ndx = getOrFindNdx(files, '', ...args);\n  return ndx >= 0 ? files[ndx] : '';\n}\n\nconst stringify = (options: any, sep: string = ',') => Object.entries(options).map(([key, value]) => `${key}=${value}`).join(sep);\n\nexport function createPopup(url: string, config: any = {}): (Window | undefined) {\n  const width = config.width || 500;\n  const height = config.height || 500;\n  const options = {\n    width: width,\n    height: height,\n    top: window.screenY + ((window.outerHeight - height) / 2.5),\n    left: window.screenX + ((window.outerWidth - width) / 2)\n  };\n  return window.open(url, '_blank', stringify(options, ',')) || undefined;\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport File from './File.js';\nimport Log from './Log.js';\nimport * as model from '../libs/model.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\nimport {getOrFindNdx} from '../libs/utils';\n\nconst kUIStateKey = 'layout2x2';\n\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"hSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"v1Sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n    \"v2Sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 2},\n  },\n  \"required\": [\"hSizes\", \"v1Sizes\", \"v2Sizes\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nfunction NamedFile(props) {\n  const {data, ndx, hackKey, register, unregister} = props;\n  const file = data.files[ndx];\n  return (\n    <File\n      //key={`ca${this.getFileKey(file)}`}\n      hackKey={hackKey}\n      desc=\"filename\"\n      title={file.name}\n      value={file.content}\n      onTitleChange={name => model.setFileName(ndx, name)}\n      onValueChange={value => model.setFileContent(ndx, value)}\n      register={register}\n      unregister={unregister}\n    />\n  );\n}\n\n\nexport default class Layout2x2 extends React.Component {\n  constructor(props) {\n    super(props);\n    this.files = new Map();\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      hSizes: [0.5, 0.5],\n      v1Sizes: [0.4, 0.6],\n      v2Sizes: [0.4, 0.5, 0.1],\n    };\n  }\n  onSetHSizes = (sizes) => {\n    this.setState({hSizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetV1Sizes = (sizes) => {\n    this.setState({v1Sizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  onSetV2Sizes = (sizes) => {\n    this.setState({v2Sizes: sizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  handleGoToLine = (data) => {\n    this.files.forEach(api => {\n      api.goToLine(data);\n    });\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const files = data.files;\n    const mainHTMLNdx = getOrFindNdx(files, 'index.html', 'html');\n    const mainJSNdx = getOrFindNdx(files, 'index.js', 'js', 'js', 'javascript');\n    const mainCSSNdx = getOrFindNdx(files, 'index.css', 'css');\n    const {hSizes, v1Sizes, v2Sizes} = this.state;\n\n    return (\n      <Split direction=\"horizontal\" minSize={0} sizes={hSizes} onSetSizes={this.onSetHSizes}>\n        <div className=\"left\">\n          <Split direction=\"vertical\" minSize={0} sizes={v1Sizes} onSetSizes={this.onSetV1Sizes}>\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainHTMLNdx} />\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainJSNdx} />\n          </Split>\n        </div>\n        <div className=\"right\">\n          <Split direction=\"vertical\" minSize={0} sizes={v2Sizes} onSetSizes={this.onSetV2Sizes}>\n            <NamedFile hackKey={hackKey} register={this.handleRegister} unregister={this.handleUnregister} data={data} ndx={mainCSSNdx} />\n            <Runner registerAPI={registerRunnerAPI} />\n            <Log onGoToLine={this.handleGoToLine} />\n          </Split>\n        </div>\n      </Split>\n    );\n  };\n}","import Ajv from 'ajv';\nimport React from 'react';\nimport Split from 'react-split-it';\n\nimport File from './File.js';\nimport Log from './Log.js';\nimport * as model from '../libs/model.js';\nimport Runner from './Runner.js';\nimport * as uiModel from '../libs/ui-model.js';\n\nconst kUIStateKey = 'layoutTabbed';\nconst uiStateSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"showResult\": { \"type\": \"boolean\" },\n    \"showLog\": { \"type\": \"boolean\" },\n    \"currentNdx\": { \"type\": \"integer\" },\n    \"sizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 3 },\n    \"lastSizes:\": { \"type\": \"array\", \"items\": {\"type\": \"number\"}, \"minItems\": 3 },\n  },\n  \"required\": [\"sizes\", \"lastSizes\", \"showResult\", \"showLog\", \"currentNdx\"],\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst uiStateValidator = ajv.compile(uiStateSchema);\n\nconst makeId = _ => `${Date.now()}-${Math.random()}`;\n\nfunction fixSizes(sizes, lastSizes, ndx, show) {\n  if (show) {\n    // we're adding a size back in.\n    const oldSize = lastSizes[ndx];\n    const availableSpace = 1 - oldSize;\n    const s = sizes.filter((_, i) => ndx !== i);\n    const len = s.reduce((sum, size) => sum + size, 0);\n    const newSizes = s.map(size => size / len * availableSpace);\n    newSizes.splice(ndx, 0, oldSize);\n    return newSizes;\n  } else {\n    // we're removing a size\n    const s = sizes.map((size, i) => ndx === i ? 0 : size);\n    const len = s.reduce((sum, size) => sum + size, 0);\n    const newSizes = s.map(size => size / len);\n    return newSizes;\n  }\n}\n\nexport default class Layout3Horizontal extends React.Component {\n  constructor(props) {\n    super(props);\n    const state = uiModel.get()[kUIStateKey];\n    this.state = uiStateValidator(state) ? state : {\n      showResult: true,\n      showLog: true,\n      currentNdx: 2,\n      sizes: [0.45, 0.45, 0.1],\n      lastSizes: [0.45, 0.45, 0.1],\n    };\n    this.files = new Map();\n    this.fileToKeyMap = new Map();\n  }\n  handleRegister = (file, api) => {\n    this.files.set(file, api);\n  }\n  handleUnregister = (file) => {\n    this.files.delete(file);\n  }\n  getFileKey(test) {\n    let key = this.fileToKeyMap.get(test);\n    if (!key) {\n      key = makeId();\n      this.fileToKeyMap.set(test, key);\n    }\n    return key;\n  }\n  setSizes = (sizes) => {\n    const lastSizes = this.state.lastSizes.slice()\n    if (this.state.currentNdx >= 0) { lastSizes[0] = sizes[0] }\n    if (this.state.showResult) { lastSizes[1] = sizes[1]; }\n    if (this.state.showLow) { lastSizes[2] = sizes[2]; }\n    this.setState({sizes, lastSizes});\n    uiModel.set(kUIStateKey, this.state);\n  }\n  handleGoToLine = (data) => {\n    // this.files is Map of File components\n    this.files.forEach((api, file) => {\n      if (api.goToLine(data)) {\n        const {files} = this.props.data;\n        // this is gross (T_T)\n        const ndx = files.findIndex(file => file.name === data.section);\n        if (ndx !== this.state.currentNdx) {\n          this.handleOnChange(ndx);\n        }\n      }\n    });\n  }\n  handleOnChange = (ndx) => {\n    const currentNdx = this.state.currentNdx === ndx ? -1 : ndx;\n    this.setState({\n      currentNdx,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 0, currentNdx >= 0),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  toggleShowLog = () => {\n    const showLog = !this.state.showLog;\n    this.setState({\n      showLog,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 2, showLog),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  toggleShowResult = () => {\n    const showResult = !this.state.showResult;\n    this.setState({\n      showResult,\n      sizes: fixSizes(this.state.sizes, this.state.lastSizes, 1, showResult),\n    });\n    uiModel.set(kUIStateKey, this.state);\n  }\n  componentDidUpdate() {\n    if (this.previousNdx !== this.state.currentNdx) {\n      this.previousNdx = this.state.currentNdx;\n      this.files.forEach(api => {\n        api.refresh();\n        api.focus();\n      });\n    }\n  }\n  render() {\n    const {hackKey, data, registerRunnerAPI} = this.props;\n    const {showResult, showLog, sizes, currentNdx} = this.state;\n    const resultStyle = {...(!showResult && {display: 'none'})}\n    const logStyle = {...(!showLog && {display: 'none'})}\n    return (\n      <div className=\"layout-tabbed\">\n        <div className=\"layout-tabbed-top\">\n          <div className=\"tab-tabs\">\n            {\n              data.files.map((file, ndx) => {\n                const key = `ca${this.getFileKey(file)}`;\n                return (\n                  <React.Fragment key={key}>\n                    <input\n                      type=\"radio\"\n                      name=\"tabbed-files\"\n                      id={key}\n                      checked={ndx === currentNdx}\n                      onClick={_ => this.handleOnChange(ndx)}\n                      onChange={_ => _} /* this is to shut up react */\n                    />\n                    <label htmlFor={key}>{file.name}</label>\n                  </React.Fragment>\n                );\n              })\n            }\n            <input\n              type=\"checkbox\"\n              checked={showResult}\n              onChange={this.toggleShowResult}\n              id=\"result\"\n            />\n            <label htmlFor=\"result\">result</label>\n            <input\n              type=\"checkbox\"\n              checked={showLog}\n              onChange={this.toggleShowLog}\n              id=\"log\"\n            />\n            <label htmlFor=\"log\">log</label>\n          </div>\n        </div>\n        <Split direction=\"vertical\" minSize={0} sizes={sizes} onSetSizes={this.setSizes}>\n          <div className=\"tab-content\">\n          {\n            data.files.map((file, ndx) => {\n              const key = `ca${this.getFileKey(file)}`;\n              return (\n                <div key={key} style={{...(ndx !== currentNdx && {display: 'none'})}}>\n                  <File\n                    hackKey={hackKey}\n                    desc=\"filename\"\n                    title={file.name}\n                    value={file.content}\n                    onTitleChange={name => model.setFileName(ndx, name)}\n                    onValueChange={value => model.setFileContent(ndx, value)}\n                    register={this.handleRegister}\n                    unregister={this.handleUnregister}\n                  />\n                </div>\n              );\n            })\n          }\n          </div>\n          <div className=\"layout-tabbed-result\" style={resultStyle}><Runner registerAPI={registerRunnerAPI} /></div>\n          <div className=\"layout-tabbed-log\" style={logStyle}><Log onGoToLine={this.handleGoToLine} /></div>\n        </Split>\n      </div>\n    );\n  };\n}","import React from 'react';\n\nimport Layout3Vertical from './Layout3Vertical.js';\nimport Layout3Horizontal from './Layout3Horizontal.js';\nimport Layout2x2 from './Layout2x2.js';\nimport LayoutTabbed from './LayoutTabbed.js';\n\nimport * as uiModel from '../libs/ui-model.js';\n\nconst layoutModes = [\n  Layout3Vertical,\n  Layout3Horizontal,\n  Layout2x2,\n  LayoutTabbed,\n];\n\nexport default class IDE extends React.Component {\n  componentDidMount() {\n    uiModel.subscribe(this.handleChange);\n  }\n  componentWillUnmount() {\n    uiModel.unsubscribe(this.handleChange);\n  }\n  handleChange = () => {\n    this.forceUpdate();\n  }\n  render() {\n    const mode = uiModel.get().layout;\n    return React.createElement(layoutModes[mode], this.props);\n  }\n}\n\n","import Ajv from 'ajv';\nimport * as model from './model.js';\nimport {storageManager} from '../globals.js';\nconst gistsKey = 'gists';\n\nconst gistSchema = {\n  \"type\": \"object\",\n  \"properties\": {\n    \"name\": { \"type\": \"string\" },\n    \"date\": { \"type\": \"string\" },\n  },\n  \"required\": [\"name\", \"date\"],\n};\n\nconst gistsSchema = {\n  \"$schema\": \"http://json-schema.org/schema#\",\n  \"type\": \"object\",\n  \"additionalProperties\": gistSchema,\n};\nconst ajv = new Ajv() // options can be passed, e.g. {allErrors: true}\nconst gistsValidator = ajv.compile(gistsSchema);\nconst gistValidator = ajv.compile(gistSchema);\n\nfunction getStoredGists() {\n  try {\n    const gists = JSON.parse(storageManager.get(gistsKey));\n    if (!gistsValidator(gists)) {\n      storageManager.delete(gistsKey);\n      throw new Error();\n    }\n    return gists;\n  } catch(e) {\n    return {};\n  }\n}\n\nmodel.add('gists', getStoredGists());\n\n// does this need to be centralized?\nstorageManager.subscribe(gistsKey, () => {\n  model.set('gists', getStoredGists());\n});\n\nexport function addGist(id, name, date, _public) {\n  const gist = {name, date, public: _public};\n  if (!gistValidator(gist)) {\n    throw new Error(`gist not valid:\\n${gistValidator.errors.map(e => `${e.message}: ${e.dataPath}`)}`)\n  }\n  const gists = {...model.get('gists')};\n  gists[id] = gist;\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nexport function removeGist(id) {\n  const gists = {...model.get('gists')};\n  delete gists[id];\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nfunction saveGistsToLocalStorage(gists) {\n  // send to other windows\n  storageManager.set(gistsKey, JSON.stringify(gists));\n}\n\nexport function getGists() {\n  return model.get('gists');\n}\n\nexport function setGists(gists) {\n  if (!gistsValidator(gists)) {\n    throw new Error(`gists not valid:\\n${gistValidator.errors.map(e => `${e.message}: ${e.dataPath}`)}`)\n  }\n  model.set('gists', gists);\n  saveGistsToLocalStorage(gists);\n}\n\nexport function subscribe(fn) {\n  model.subscribe('gists', fn);\n}\n\nexport function unsubscribe(fn) {\n  model.unsubscribe('gists', fn);\n}\n","import React from 'react';\nimport EditLine from './EditLine.js';\nimport {classNames} from '../libs/css-utils.js';\nimport * as gists from '../libs/gists.js';\nimport ServiceContext from '../ServiceContext.js';\n\ntype Gist = {\n  name: string,\n  date: string,\n  public: boolean,\n  id: string,\n}\n\n// ( ) Wrap table with div, scroll div. Because table expands to 100%\n\ninterface GistIdMap {\n   [key: string]: Gist;\n} \n\ntype LoadGistState = {\n  loading: boolean,\n  gists: GistIdMap,\n  checks: Set<string>,\n  filter: string,  // TODO: move up\n  sortKey: string, // TODO: move up\n  sortDir: string, // TODO: move up\n};\n\nfunction getSortFn(sortKey: string, checks: Set<string>): (a: Gist, b: Gist) => number {\n  switch (sortKey) {\n    case 'name':\n      return (a: Gist, b: Gist) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : (a.name.toLowerCase() > b.name.toLowerCase() ? 1 : 0);\n    case 'date':\n      return (a: Gist, b: Gist) => a.date < b.date ? -1 : (a.date > b.date ? 1 : 0);\n    case 'public':\n      return (a: Gist, b: Gist) => {\n        const ap = a.public ? 1 : 0;\n        const bp = b.public ? 1 : 0;\n        return Math.sign(ap - bp);\n      };\n    case 'check':\n      return (a: Gist, b: Gist) => {\n        const ap = checks.has(a.id) ? 1 : 0;\n        const bp = checks.has(b.id) ? 1 : 0;\n        return Math.sign(ap - bp);\n      };\n    default:\n      throw new Error('unknown sortKey');\n  }\n}\n\nfunction gistsToSortedArray(gists: GistIdMap, checks: Set<string>, sortKey: string, sortDir: string) {\n  const compareDirMult = sortDir === 'down' ? 1 : -1;\n  const compFn = getSortFn(sortKey, checks);\n  console.log('sortDir:', compareDirMult);\n  return Object.entries(gists).map(([id, {name, date, public: _public}]) => {\n    return {id, name, date, public: _public};\n  }).sort((b, a) => compFn(a, b) * compareDirMult);\n}\n\nfunction matchFilter(filter: string) {\n  filter = filter.trim().toLowerCase();\n  return function(gist: Gist) {\n    const {name, date} = gist;\n    return filter === '' ||\n           name.toLowerCase().includes(filter) ||\n           date.substring(0, 10).includes(filter);\n  }\n}\n\n\ntype SortKeyInfo = {\n  sortDir: string,\n  selected: boolean,\n  update: (sortDir: string) => void,\n};\n\nfunction SortBy(props: SortKeyInfo) {\n  const {sortDir, selected, update} = props;\n  return (\n    <React.Fragment>\n      <span onClick={() => update(!selected ? sortDir : (sortDir === 'up' ? 'down' : 'up'))} className={selected ? 'current-sort-key' : ''}>{sortDir === 'up' ? '▲' : '▼'}</span>\n    </React.Fragment>\n  );\n}\n\nexport default class LoadGist extends React.Component<{}, LoadGistState> {\n  constructor (props: {}) {\n    super(props);\n    const _gists = gists.getGists();\n    this.state = {\n      loading: false,\n      gists: _gists,\n      checks: new Set(),\n      filter: '',\n      sortKey: 'date',\n      sortDir: 'down',\n    };\n  }\n  handleNewGists = (gists: GistIdMap) => {\n    this.setState({\n      gists,\n    });\n  }\n  toggleCheck = (id: string) => {\n    const checks = new Set(this.state.checks);\n    if (checks.has(id)) {\n      checks.delete(id);\n    } else {\n      checks.add(id);\n    }\n    this.setState({checks});\n  }\n  onUserStatusChange = () => {\n    this.forceUpdate();\n    const {userManager} = this.context;\n    if (userManager.getUserData()) {\n      this.loadGists();\n    }\n  }\n  updateSort = (sortKey: string, sortDir: string) => {\n    console.log('update:', sortKey, sortDir);\n    this.setState({sortDir, sortKey});\n  }\n  componentDidMount() {\n    const {userManager} = this.context;\n    gists.subscribe(this.handleNewGists);\n    userManager.subscribe(this.onUserStatusChange);\n  }\n  componentWillUnmount() {\n    const {userManager} = this.context;\n    gists.unsubscribe(this.handleNewGists);\n    userManager.unsubscribe(this.onUserStatusChange);\n  }\n  loadGists = async() => {\n    const {addError, github} = this.context;\n    this.setState({loading: true});\n    try {\n      const gistArray = await github.getUserGists();\n      const gistsById = gistArray.reduce((gists: any[], gist: any) => {\n        gists[gist.id] = {\n          name: gist.description,\n          date: gist.updated_at,\n          public: gist.public,\n        };\n        return gists;\n      }, {});\n      gists.setGists(gistsById);\n    } catch (e) {\n      addError(`could not load gists: ${e}`);\n    }\n    this.setState({loading: false});\n  }\n  deleteSelected = async() => {\n    const {checks, gists: _gists} = this.state;\n    const ids: string[] = [];\n    // just incase?\n    checks.forEach((id, ndx) => {\n      if (_gists[id]) {\n        ids.push(id);\n      }\n    });\n    const {addError, github} = this.context;\n    this.setState({loading: true});\n    for (const id of ids) {\n      try {\n        await github.deleteGist(id);\n        gists.removeGist(id);\n      } catch(e) {\n        addError(`could not delete gist: ${id}: ${e}`);\n      }\n    }\n    this.setState({loading: false});\n  }\n  clearBackup = () => {\n    const {backupManager} = this.context;\n    backupManager.clearBackup();\n  }\n  renderLogin() {\n    const {userManager} = this.context;\n    return (\n      <div>\n        <button\n          onClick={userManager.login}\n        >Login with github</button>\n      </div>\n    );\n  }\n  renderLoad() {\n    const {userManager} = this.context;\n    const {gists, checks, loading, filter, sortKey, sortDir} = this.state;\n    const userData = userManager.getUserData();\n    const canLoad = !!userData && !loading;\n    const gistArray = gistsToSortedArray(gists, checks, sortKey, sortDir);\n    return (\n      <div>\n        <p>\n          <button\n            className={classNames({disabled: !canLoad})}\n            onClick={this.loadGists}\n          >{gistArray.length ? 'Reload' : 'Load'} Your Gists</button>\n        </p>\n         {\n            gistArray.length >= 0 &&\n              <React.Fragment>\n              <p>\n                <EditLine className=\"foobar\" placeholder=\"search:\" value={filter} onChange={(filter:string) => {this.setState({filter})}} />\n              </p>\n              <div className=\"gists\">\n                <table>\n                  <thead>\n                    <tr>\n                      <th><SortBy selected={sortKey === 'check'} sortDir={sortDir} update={(dir: string) => this.updateSort('check', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'name'} sortDir={sortDir} update={(dir: string) => this.updateSort('name', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'date'} sortDir={sortDir} update={(dir: string) => this.updateSort('date', dir)}/></th>\n                      <th><SortBy selected={sortKey === 'public'} sortDir={sortDir} update={(dir: string) => this.updateSort('public', dir)}/></th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  {\n                    gistArray.filter(matchFilter(filter)).map((gist, ndx) => {\n                      return (\n                        <tr key={`g${ndx}`}>\n                          <td><input type=\"checkbox\" id={`gc${ndx}`} checked={checks.has(gist.id)} onChange={() => this.toggleCheck(gist.id)}/><label htmlFor={`gc${ndx}`}/></td>\n                          <td><a onClick={this.clearBackup} href={`${window.location.origin}?src=${encodeURIComponent(gist.id)}`}>{gist.name}</a></td>\n                          <td>{gist.date.substring(0, 10)}</td>\n                          <td>{gist.public ? '' : '🔒'}</td>\n                        </tr>\n                      );\n                    })\n                  }\n                  </tbody>\n                </table>\n              </div>\n              <div><button onClick={this.deleteSelected}>Delete Selected Gists</button></div>\n              </React.Fragment>\n          }\n      </div>\n    );\n  }\n  render() {\n    const {userManager} = this.context;\n    const userData = userManager.getUserData();\n    return userData ? this.renderLoad() : this.renderLogin();\n  }\n}\n\nLoadGist.contextType = ServiceContext;\n","import {decode, encode} from 'base64-arraybuffer';\nimport {inflate, deflate} from 'uzip-module';\n\nconst utf8Encoder = new TextEncoder();\nconst utf8Decoder = new TextDecoder();\nconst compressedPrefix = 'cb64,';\nconst uncompressedPrefix = 'b64,';\n\nexport const isCompressedBase64 = s => s.startsWith(compressedPrefix) || s.startsWith(uncompressedPrefix);\nexport function compressedBase64ToJSON(src) {\n  const isCompressed = src.startsWith(compressedPrefix);\n  const prefix = isCompressed ? compressedPrefix : uncompressedPrefix;\n  const base64 = src.substr(prefix.length)\n     .replace(/-/g, '+')\n     .replace(/_/g, '/');\n  const raw = new Uint8Array(decode(base64));\n  const bin = isCompressed \n     ? inflate(raw)\n     : raw;\n  const json = utf8Decoder.decode(bin);\n  return JSON.parse(json);\n}\n\nexport function jsonToCompressedBase64(data) {\n  const json = JSON.stringify(data);\n  const bin = utf8Encoder.encode(json);\n  const compressed = deflate(bin);\n  const useCompressed = compressed.length < bin.length;\n  const base64 = encode(useCompressed ? compressed : bin)\n      .replace(/\\+/g, '-')    // better for URLs because + and / have to be escaped\n      .replace(/\\//g, '_');\n  const prefix = useCompressed ? compressedPrefix : uncompressedPrefix;\n  return `${prefix}${base64}`;\n}\n","\nimport {clientId} from '../globals.js';\nimport {createURL} from './url.js';\nimport {createPopup} from './utils';\nimport StorageManager from './StorageManager';\nimport * as winMsgMgr from './WindowMessageManager';\n\nconst patKey = 'pat';\n\nconst getTokenURL = process.env.REACT_APP_OAUTH_HELPER_URL;\nif (!getTokenURL) {\n  throw Error ('must set environment variable: OAUTH_HELPER_URL');\n}\n\nexport default class OAuthManager {\n  private _popup?: Window;\n  private _state?: string;\n  private _storageManager: StorageManager;\n\n  constructor(storageManager: StorageManager) {\n    this._popup = undefined;\n    this._state = undefined;  // last state sent to auth\n    this._storageManager = storageManager;\n    winMsgMgr.on('auth', null, (data: any) => {\n      this._closePopup();\n      if (data.state === this._state) {\n        this.requestToken(data);\n      }\n    });\n  }\n  // TODO: rename this and decide if Github should be connected\n  pat() {\n    return this._storageManager.get(patKey);\n  }\n  subscribe(fn: () => void) {\n    this._storageManager.subscribe(patKey, fn);\n  }\n  unsubscribe(fn: () => void) {\n    this._storageManager.unsubscribe(patKey, fn);\n  }\n  _closePopup() {\n    if (this._popup) {\n      this._popup.close();\n      this._popup = undefined;\n    }\n  }\n  requestToken = async (auth: any) => {\n    try {\n      const params = {\n        client: clientId,\n        code: auth.code,\n      };\n      const url = createURL(getTokenURL, params);\n      const req = await fetch(url);\n      const data = await req.json();\n      if (!data.access_token) {\n        throw new Error(JSON.stringify(data));\n      }\n      this._storageManager.set(patKey, data.access_token);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  logout = () => {\n    this._storageManager.delete(patKey);\n  }\n  login = () => {\n    this._closePopup();\n    this._state = `${Date.now()}-${Math.random()}`;  // does this need to special? Seems like no\n    const url = createURL('https://github.com/login/oauth/authorize', {\n      client_id: clientId,\n      scope: 'gist',\n      state: this._state,\n    });\n    this._popup = createPopup(url);\n  }\n}","module.exports = __webpack_public_path__ + \"static/media/vertical-layout.f248a432.svg\";","module.exports = __webpack_public_path__ + \"static/media/horizontal-layout.e3f3298b.svg\";","module.exports = __webpack_public_path__ + \"static/media/two-by-two-layout.23605ce8.svg\";","module.exports = __webpack_public_path__ + \"static/media/tabbed-layout.8a8b9bc8.svg\";"],"sourceRoot":""}